[
  {
    "path": "posts/2022-05-02-example-of-embedded-excel-snippet/",
    "title": "Example of embedded Excel snippet",
    "description": "Excel workbook (or ranges) can be embedded in the classic iframe",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-05-02",
    "categories": [],
    "contents": "\r\nThis is a distill blog etc\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2022-05-02T18:16:31-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-30-bt-pq-p1t2211-set-non-stationary-time-series-models-basic/",
    "title": "BT PQ P1.T2.21.1 (SET) Non-stationary time series (2021)",
    "description": "Seasonal dummy model, roots of characteristic equation, and transformation (difference versus detrend) of non-stationary process",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-25",
    "categories": [],
    "contents": "\r\n21.1.1 This is a seasonal model without a trend\r\n21.1.1 The following seasonal dummy model estimates the quarterly growth rate (in percentage terms) of housing starts … The model’s intercept (δ) equals +1.20 and the gamma coefficients are the following: γ(1) = -2.60, γ(2) = +7.90, and γ(3) = +1.80. According to this model, when does the growth rate peak?\r\n\r\n\r\n# similar to GARP's EOC 11.8, there is no trend, only seasonality\r\n\r\nc_delta <- 1.20; gamma <- c(-2.6, 7.9, 1.80, 0) \r\nquarters <- rep(1:4, 5)  \r\ny = c_delta + gamma[quarters]\r\nts.plot(y)\r\n\r\n\r\n\r\n\r\n21.1.2 An AR(2) that is stationary as demonstrated by |roots| > 1.0 but also our ability to simulate\r\n21.1.2. Peter wants to model the following AR(2) time series: Y(t) = 0.750Y(t-1) - 0.1250T(t-2) + e(t). He wonders if this AR(2) is stationary. He realizes that he can write this as a log polynomial …\r\n\r\n\r\n# install.packages(\"polynom\", repos = \"http://cran.us.r-project.org\")\r\nlibrary(polynom)\r\n\r\npeters_poly <- polynomial(coef = c(1, -0.75, 0.125)) \r\npeters_poly\r\n\r\n\r\n1 - 0.75*x + 0.125*x^2 \r\n\r\nsolve(peters_poly) # the roots (aka, zeros) are 2 and 4\r\n\r\n\r\n[1] 2 4\r\n\r\nar_2 <-  arima.sim(model=list(order=c(2,0,0),ar = c(-0.75, 0.125)),n = 100)\r\nts.plot(ar_2)\r\n\r\n\r\n\r\n\r\n21.1.3 Compares a deterministic trend to a stochastic (random walk with drift) trend\r\n21.1.3. Sally considers two series for her model: a linear trend model (aka, deterministic trend), and a random walk with drift. Each is simulated below (n = 100 steps)\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(ggthemes)\r\nlibrary(RColorBrewer)\r\n\r\nset.seed(28)\r\n\r\nn <- 100\r\nx <- 1:n\r\n\r\n# white noise\r\nwhite_noise <- arima.sim(model = list(order = c(0,0,0)), n = 100)\r\n\r\n#linear trend\r\nlinear_tr <- -1.8 + 0.15*x\r\ntime_trend <- linear_tr + white_noise\r\n\r\nrw_drift <- arima.sim(model = list(order = c(0,1,0)), n = n-1, mean = 0.4)\r\n\r\ntrends <- data.frame(\r\n  x,\r\n  time_trend,\r\n  rw_drift\r\n)\r\n\r\np1 <- trends %>% ggplot(aes(x=x)) +\r\n  geom_line(aes(y=rw_drift), color = \"blue\", size = 2) +\r\n  geom_line(aes(y=time_trend), color = \"orange\", size = 2) +\r\n  theme_minimal() +\r\n  theme(\r\n    axis.title = element_blank(),\r\n    axis.text = element_text(size = 14)\r\n  )\r\n    \r\np1\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-30-bt-pq-p1t2211-set-non-stationary-time-series-models-basic/21-1-3-plot.png",
    "last_modified": "2022-01-30T17:36:09-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-30-bt-pq-p1t22025-set-long-horizon-arma-forecasting/",
    "title": "BT PQ P1.T2.20.25 (SET) Long-horizon AR(p) MA(q) forecasts",
    "description": "The long-run mean of an MA(q) process is the intercept; of the AR(p) process is delta/(1 - sum of params)",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-23",
    "categories": [],
    "contents": "\r\n20.25.1. Below is plotted the monthly growth rate of a new cryptocurrency over the prior ten months. Two months ago, the growth rate was +0.782%. Last month, the growth rate was +2.072%. We will omit the percentage symbol (%) and assume the growth rates are percentages; specifically, Y(9) = Y(t-2) = +0.782 and Y(10) = Y(t-1) = +2.072\r\n*** plot goes here ***\r\nYour colleagues have determined that the best model for this series is an AR(2) model which is given by Y(t) = ẟ + ϕ(1)*Y(t-1) + ϕ(2)*Y(t-2) + ε(t). In this instance of the model, the intercept is 0.40, the first AR parameter is 0.50 and the second AR parameter is 0.30; specifically, the model is given by Y(t) = 0.40 + 0.50*Y(t-1) + 0.30*Y(t-2) + ε(t). Please note that the intercept of 0.40 here represents 0.40% such that, in decimal terms, the model is given by Y(t) = 0.0040 + 0.50*Y(t-1) + 0.30*Y(t-2) + ε(t) where Y(t-2) = 0.007820 and Y(t-1) = 0.020720 but the AR parameters remain 0.50 and 0.30.\r\nNote that we can markdown/LaTex to render the math. For example, where $ signifies inline LaTex, $$ signifies new line such that the AR(2) is given by \\[Y_t =\\delta + \\phi_1Y_{t-1} +\\phi_2Y_{t-2}+\\epsilon_t\\]\r\n\r\n\r\nlibrary(tidyverse)\r\nset.seed(13)\r\n\r\nAR_param_1 = 0.5\r\nAR_param_2 = 0.3\r\nAR_intercept = 0.4\r\nAR_n <- 10\r\nAR_LR <- AR_intercept/(1- AR_param_1 - AR_param_2)\r\n\r\ntheme_set(theme_bw())\r\n\r\n# arima.sim model c(p, d, q)\r\n# p = AR order\r\n# d = difference\r\n# q = MA order\r\n# Generate an AR(2) with parameters, AR_param_1 and AR_param_2\r\n# Not this: AR <- arima.sim(model=list(order=c(2,0,0), ar = c(AR_param_1, AR_param_2)), n = AR_n) + AR_intercept\r\nAR <- arima.sim(model=list(order=c(2,0,0), ar = c(AR_param_1, AR_param_2)), n = AR_n, mean = AR_intercept)\r\n\r\nAR <- round(AR, digits = 3)\r\nAR_tb <- AR %>% as_tibble() %>% rowid_to_column()\r\n\r\n# reduced to 80% on copy/paste\r\nAR_tb %>% \r\n  ggplot(aes(rowid, x)) + \r\n  ylab(\"Growth (%)\") +\r\n  theme(\r\n    text = element_text(family = \"Calibri\"), \r\n    axis.title.x = element_blank(),\r\n    axis.title.y = element_text(size = 13, face = \"bold\", margin = margin(0,10,0,0)),\r\n    axis.text = element_text(size = 13, face = \"bold\")\r\n  ) +\r\n  geom_line(size = 1) +\r\n  geom_point(size = 4) + \r\n  scale_x_continuous(breaks = seq(1, 10, 1), minor_breaks = NULL) +\r\n  scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) +\r\n  geom_text(aes(label = x), size = 4, color = \"darkgreen\", fontface = \"bold\", nudge_y = 0.2, nudge_x = .62)\r\n\r\n\r\n\r\nAR[9] # the ts not the tibble\r\n\r\n\r\n[1] 0.782\r\n\r\nAR[10]\r\n\r\n\r\n[1] 2.072\r\n\r\nAR_11 <- AR_intercept + AR_param_1 * AR[10] + AR_param_2 * AR[9]\r\nAR_12 <- AR_intercept + AR_param_1 * AR_11 + AR_param_2 * AR[10]\r\n\r\nAR_tb <- cbind(AR_tb, cat = rep(\"Past\",10))\r\nAR_tb <- AR_tb %>% add_row(rowid = 11, x = AR_11, cat = \"projected\")\r\nAR_tb <- AR_tb %>% add_row(rowid = 12, x = AR_12, cat = \"projected\")\r\n\r\nAR_tb %>% \r\n  ggplot(aes(rowid, x, group = cat, color = cat)) +\r\n  geom_line() +\r\n  geom_point(size = 4) +\r\n  # xlim(0, 13)\r\n  # scale_x_discrete(limits = c(0,13), breaks = 1)\r\n  scale_x_continuous(breaks = seq(1, 12, 1), minor_breaks = NULL)\r\n\r\n\r\n\r\nAR_11\r\n\r\n\r\n[1] 1.6706\r\n\r\nAR_12\r\n\r\n\r\n[1] 1.8569\r\n\r\n20.25.3. Long-run mean\r\n20.25.2.Jennifer is an analyst who is deciding which second-order model to fit to her time series dataset. She prefer to fit either an MA(2) or AR(2) model:\r\nMA(2): Y(t) = μ + θ(1)ε(t-1) + θ(2)ε(t-2) + ε(t)\r\nAR(2): Y(t) = ẟ + ϕ(1)Y(t-1) + ϕ(2)Y(t-2) + ε(t)\r\nShe is evaluating the models with the same parameters: an intercept of 0.590 and weights of 0.460 and 0.180 such that the two models are specified as follows:\r\nMA(2): Y(t) = 0.590 + 0.460ε(t-1) + 0.180ε(t-2) + ε(t)\r\nAR(2): Y(t) = 0.590 + 0.460Y(t-1) + 0.180Y(t-2) + ε(t)\r\nWhat are, respectively, the long-run (aka, unconditional) means of these two models?\r\n\r\n\r\nset.seed(22)\r\n\r\nAR2_param_1 = 0.460\r\nAR2_param_2 = 0.180\r\nAR2_intercept = 0.590\r\nAR2_n <- 10\r\n\r\ntheme_set(theme_bw())\r\n\r\n# arima.sim model c(p, d, q)\r\n# p = AR order\r\n# d = difference\r\n# q = MA order\r\n# Generate an AR(2) with parameters, AR_param_1 and AR_param_2\r\n# Not this: AR <- arima.sim(model=list(order=c(2,0,0), ar = c(AR_param_1, AR_param_2)), n = AR_n) + AR_intercept\r\nAR2 <- arima.sim(model=list(order=c(2,0,0), ar = c(AR2_param_1, AR2_param_2)), n = AR2_n, mean = AR2_intercept)\r\n\r\nAR2 <- round(AR2, digits = 3)\r\nAR2_tb <- AR2 %>% as_tibble() %>% rowid_to_column()\r\n\r\nAR2_tb %>% \r\n  ggplot(aes(rowid, x)) + \r\n  geom_line()\r\n\r\n\r\n\r\nAR2_11 <- AR2_intercept + AR2_param_1 * AR2[10] + AR2_param_2 * AR2[9]\r\nAR2_12 <- AR2_intercept + AR2_param_1 * AR2_11 + AR2_param_2 * AR2[10]\r\nAR2_13 <- AR2_intercept + AR2_param_1 * AR2_12 + AR2_param_2 * AR2_11\r\nAR2_14 <- AR2_intercept + AR2_param_1 * AR2_13 + AR2_param_2 * AR2_12\r\n\r\nx = vector(mode= \"numeric\", length = 30)\r\nx[1] = AR2_13\r\nx[2] = AR2_14\r\nfor (i in 3:30) {\r\n  x[i] <- AR2_intercept + AR2_param_1 * x[i-1] + AR2_param_2 * x[i-2]\r\n}\r\n\r\nplot(x)\r\n\r\n\r\n\r\nAR2_11\r\n\r\n\r\n[1] 0.95892\r\n\r\nAR2_12\r\n\r\n\r\n[1] 1.037763\r\n\r\nAR2_13\r\n\r\n\r\n[1] 1.239977\r\n\r\nAR2_14\r\n\r\n\r\n[1] 1.347187\r\n\r\nx[3]\r\n\r\n\r\n[1] 1.432902\r\n\r\nx[4]\r\n\r\n\r\n[1] 1.491628\r\n\r\nx[5]\r\n\r\n\r\n[1] 1.534071\r\n\r\nx[28]\r\n\r\n\r\n[1] 1.638846\r\n\r\nx[29]\r\n\r\n\r\n[1] 1.638858\r\n\r\nx[30]\r\n\r\n\r\n[1] 1.638867\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-30-bt-pq-p1t22025-set-long-horizon-arma-forecasting/t2-20-25-1-crypto-plot.png",
    "last_modified": "2022-01-30T17:34:46-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-29-bt-pq-p1t220243-aic-and-bic/",
    "title": "BT PQ P1.T2.20.24.3 AIC and BIC",
    "description": "Penalized MSE measures are called information criteria (IC) and two popular such measures are the Akaike Information Crite-rion (AIC) and the Bayesian Information Criterion (BIC).",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-21",
    "categories": [],
    "contents": "\r\n20.24.3. Eric is a commodity analyst who fit four different candidate AR(p) models to a series of oil prices. For each of the candidate models, he then retrieved the Akaike information criterion (AIC) and the Bayesian information criterion (BIC). The results are displayed below.\r\n.. AIC and BIC values (table below) goes here …\r\nAs Eric interprets the results of these criteria (i.e., the AIC and BIC values), which of the following statements is TRUE?\r\nBoth criteria (AIC and BIC) favor the AR(1) model\r\nBoth criteria (AIC and BIC) favor the AR(2) model\r\nAs both criteria are insignificant, any AR(p) model is a bad fit\r\nThe criteria disagree and therefore the AIC’s preference should prevail because it prefers fewer lags\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(scales)\r\nlibrary(gridExtra)\r\nlibrary(forecast)\r\nlibrary(tseries)\r\nlibrary(fpp2)\r\nlibrary(gt)\r\nlibrary(astsa)\r\n\r\n# 175\r\nset.seed(175)\r\nar2 <- arima.sim(model=list(order=c(2,0,0),ar = c(1.5,-.75)),n = 500)\r\nma2 <- arima.sim(model=list(order=c(0,0,2),ma = c(1.5,-.75)),n = 500)\r\n\r\nar1_fit <- sarima(ar2, p = 1, d = 0, q = 0)\r\n\r\n\r\ninitial  value 1.185288 \r\niter   2 value 0.473121\r\niter   3 value 0.473113\r\niter   4 value 0.473112\r\niter   5 value 0.473108\r\niter   6 value 0.473099\r\niter   7 value 0.473095\r\niter   8 value 0.473094\r\niter   9 value 0.473092\r\niter  10 value 0.473087\r\niter  11 value 0.473080\r\niter  12 value 0.473076\r\niter  13 value 0.473075\r\niter  14 value 0.473075\r\niter  15 value 0.473075\r\niter  16 value 0.473074\r\niter  17 value 0.473073\r\niter  18 value 0.473073\r\niter  19 value 0.473073\r\niter  20 value 0.473073\r\niter  21 value 0.473072\r\niter  22 value 0.473072\r\niter  23 value 0.473072\r\niter  24 value 0.473072\r\niter  25 value 0.473072\r\niter  26 value 0.473072\r\niter  27 value 0.473072\r\niter  27 value 0.473072\r\niter  27 value 0.473072\r\nfinal  value 0.473072 \r\nconverged\r\ninitial  value 0.475632 \r\niter   2 value 0.475627\r\niter   3 value 0.475615\r\niter   4 value 0.475613\r\niter   5 value 0.475597\r\niter   6 value 0.475583\r\niter   7 value 0.475579\r\niter   8 value 0.475574\r\niter   9 value 0.475573\r\niter  10 value 0.475570\r\niter  11 value 0.475569\r\niter  12 value 0.475569\r\niter  13 value 0.475569\r\niter  13 value 0.475569\r\niter  13 value 0.475569\r\nfinal  value 0.475569 \r\nconverged\r\n\r\nar2_fit <- sarima(ar2, p = 2, d = 0, q = 0)\r\n\r\n\r\ninitial  value 1.186082 \r\niter   2 value 1.063752\r\niter   3 value 0.611728\r\niter   4 value 0.360300\r\niter   5 value 0.180452\r\niter   6 value 0.026222\r\niter   7 value 0.023222\r\niter   8 value 0.022348\r\niter   9 value 0.022310\r\niter  10 value 0.022284\r\niter  11 value 0.022258\r\niter  12 value 0.022258\r\niter  13 value 0.022258\r\niter  14 value 0.022258\r\niter  15 value 0.022258\r\niter  16 value 0.022258\r\niter  17 value 0.022258\r\niter  17 value 0.022258\r\niter  17 value 0.022258\r\nfinal  value 0.022258 \r\nconverged\r\ninitial  value 0.028108 \r\niter   2 value 0.028095\r\niter   3 value 0.028087\r\niter   4 value 0.028086\r\niter   5 value 0.028086\r\niter   6 value 0.028085\r\niter   7 value 0.028085\r\niter   8 value 0.028085\r\niter   8 value 0.028085\r\nfinal  value 0.028085 \r\nconverged\r\n\r\nar3_fit <- sarima(ar2, p = 3, d = 0, q = 0)\r\n\r\n\r\ninitial  value 1.187086 \r\niter   2 value 0.966297\r\niter   3 value 0.720122\r\niter   4 value 0.651535\r\niter   5 value 0.270365\r\niter   6 value 0.157749\r\niter   7 value 0.106223\r\niter   8 value 0.068752\r\niter   9 value 0.027592\r\niter  10 value 0.020453\r\niter  11 value 0.020449\r\niter  12 value 0.020445\r\niter  13 value 0.020430\r\niter  14 value 0.020418\r\niter  15 value 0.020418\r\niter  16 value 0.020418\r\niter  17 value 0.020418\r\niter  18 value 0.020418\r\niter  19 value 0.020418\r\niter  20 value 0.020418\r\niter  20 value 0.020418\r\niter  20 value 0.020418\r\nfinal  value 0.020418 \r\nconverged\r\ninitial  value 0.027093 \r\niter   2 value 0.027090\r\niter   3 value 0.027084\r\niter   4 value 0.027079\r\niter   5 value 0.027079\r\niter   6 value 0.027078\r\niter   7 value 0.027078\r\niter   8 value 0.027078\r\niter   8 value 0.027078\r\niter   8 value 0.027078\r\nfinal  value 0.027078 \r\nconverged\r\n\r\nar4_fit <- sarima(ar2, p = 4, d = 0, q = 0)\r\n\r\n\r\ninitial  value 1.187677 \r\niter   2 value 1.182760\r\niter   3 value 0.389837\r\niter   4 value 0.312734\r\niter   5 value 0.257361\r\niter   6 value 0.134886\r\niter   7 value 0.042493\r\niter   8 value 0.035479\r\niter   9 value 0.028843\r\niter  10 value 0.020356\r\niter  11 value 0.020308\r\niter  12 value 0.020305\r\niter  13 value 0.020305\r\niter  14 value 0.020305\r\niter  15 value 0.020304\r\niter  16 value 0.020304\r\niter  17 value 0.020304\r\niter  18 value 0.020304\r\niter  19 value 0.020304\r\niter  20 value 0.020304\r\niter  21 value 0.020304\r\niter  22 value 0.020304\r\niter  22 value 0.020304\r\niter  22 value 0.020304\r\nfinal  value 0.020304 \r\nconverged\r\ninitial  value 0.026957 \r\niter   2 value 0.026941\r\niter   3 value 0.026940\r\niter   4 value 0.026938\r\niter   5 value 0.026937\r\niter   6 value 0.026936\r\niter   7 value 0.026936\r\niter   8 value 0.026936\r\niter   9 value 0.026936\r\niter   9 value 0.026936\r\niter   9 value 0.026936\r\nfinal  value 0.026936 \r\nconverged\r\n\r\nma1_fit <- sarima(ma2, p = 0, d = 0, q = 1)\r\n\r\n\r\ninitial  value 0.620720 \r\niter   2 value 0.616967\r\niter   3 value 0.616503\r\niter   4 value 0.616503\r\niter   4 value 0.616503\r\niter   4 value 0.616503\r\nfinal  value 0.616503 \r\nconverged\r\ninitial  value 0.616515 \r\niter   2 value 0.616515\r\niter   2 value 0.616515\r\niter   2 value 0.616515\r\nfinal  value 0.616515 \r\nconverged\r\n\r\nma2_fit <- sarima(ma2, p = 0, d = 0, q = 2)\r\n\r\n\r\ninitial  value 0.620720 \r\niter   2 value 0.601563\r\niter   3 value 0.601097\r\niter   4 value 0.601053\r\niter   5 value 0.601053\r\niter   5 value 0.601053\r\niter   5 value 0.601053\r\nfinal  value 0.601053 \r\nconverged\r\ninitial  value 0.601132 \r\niter   2 value 0.601132\r\niter   2 value 0.601132\r\niter   2 value 0.601132\r\nfinal  value 0.601132 \r\nconverged\r\n\r\nma3_fit <- sarima(ma2, p = 0, d = 0, q = 3)\r\n\r\n\r\ninitial  value 0.620720 \r\niter   2 value 0.601584\r\niter   3 value 0.601080\r\niter   4 value 0.600978\r\niter   5 value 0.600977\r\niter   5 value 0.600977\r\niter   5 value 0.600977\r\nfinal  value 0.600977 \r\nconverged\r\ninitial  value 0.601058 \r\niter   2 value 0.601058\r\niter   3 value 0.601058\r\niter   3 value 0.601058\r\niter   3 value 0.601058\r\nfinal  value 0.601058 \r\nconverged\r\n\r\nma4_fit <- sarima(ma2, p = 0, d = 0, q = 4)\r\n\r\n\r\ninitial  value 0.620720 \r\niter   2 value 0.599626\r\niter   3 value 0.599377\r\niter   4 value 0.599342\r\niter   5 value 0.599340\r\niter   6 value 0.599340\r\niter   7 value 0.599340\r\niter   7 value 0.599340\r\niter   7 value 0.599340\r\nfinal  value 0.599340 \r\nconverged\r\ninitial  value 0.599424 \r\niter   2 value 0.599424\r\niter   3 value 0.599424\r\niter   3 value 0.599424\r\niter   3 value 0.599424\r\nfinal  value 0.599424 \r\nconverged\r\n\r\nprint(\"AIC\")\r\n\r\n\r\n[1] \"AIC\"\r\n\r\nar1_fit$AIC\r\n\r\n\r\n[1] 3.801016\r\n\r\nar2_fit$AIC\r\n\r\n\r\n[1] 2.910047\r\n\r\nar3_fit$AIC\r\n\r\n\r\n[1] 2.912034\r\n\r\nar4_fit$AIC\r\n\r\n\r\n[1] 2.915749\r\n\r\nprint(\"BIC\")\r\n\r\n\r\n[1] \"BIC\"\r\n\r\nar1_fit$BIC\r\n\r\n\r\n[1] 3.826304\r\n\r\nar2_fit$BIC\r\n\r\n\r\n[1] 2.943764\r\n\r\nar3_fit$BIC\r\n\r\n\r\n[1] 2.95418\r\n\r\nar4_fit$BIC\r\n\r\n\r\n[1] 2.966324\r\n\r\nAIC_ar2 <- c(ar1_fit$AIC, ar2_fit$AIC, ar3_fit$AIC, ar4_fit$AIC)\r\nBIC_ar2 <- c(ar1_fit$BIC, ar2_fit$BIC, ar3_fit$BIC, ar4_fit$BIC)\r\nAIC_BIC_ar2 <- cbind(AIC_ar2, BIC_ar2) %>% data.frame()\r\nmodels <- c(\"AR(1)\", \"AR(2)\", \"AR(3)\", \"AR(4)\")\r\nmodels_AIC_BIC <- cbind(models, AIC_BIC_ar2)\r\n\r\nmodels_AIC_BIC_gt <- gt(models_AIC_BIC)\r\n\r\nmodels_AIC_BIC_gt <- \r\n  models_AIC_BIC_gt %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  # ) %>% tab_style(\r\n  #  style = cell_text(color = \"cadetblue\"),\r\n  #  locations = cells_column_labels(\r\n  #    columns = vars(model, 'h (lags)', statistic, 'p-value')\r\n  #  )\r\n  ) %>% tab_header(\r\n    title = md(\"**AIC and BIC values**\"),\r\n    subtitle = \"Four candidate models: AR(1) ... AR(4)\"\r\n  ) %>% fmt_number(\r\n    columns = vars(AIC_ar2, BIC_ar2),\r\n    decimals = 5\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"AIC = Akaike information criterion\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"BIC = Bayesian information criterion\")\r\n  # ) %>% cols_width(\r\n  #  vars(model) ~ px(70),\r\n  #  vars(statistic, 'p-value') ~ px(90)\r\n  ) %>% cols_label (\r\n    models = md(\"**model**\"),\r\n    AIC_ar2 = md(\"**AIC**\"),\r\n    BIC_ar2 = md(\"**BIC**\")\r\n  ) %>% tab_options(\r\n    heading.title.font.size = 16,\r\n    heading.subtitle.font.size = 14\r\n  )\r\n\r\nmodels_AIC_BIC_gt\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#lrwmjdgnlm .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#lrwmjdgnlm .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lrwmjdgnlm .gt_title {\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#lrwmjdgnlm .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#lrwmjdgnlm .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#lrwmjdgnlm .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lrwmjdgnlm .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#lrwmjdgnlm .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#lrwmjdgnlm .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#lrwmjdgnlm .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#lrwmjdgnlm .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#lrwmjdgnlm .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#lrwmjdgnlm .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#lrwmjdgnlm .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#lrwmjdgnlm .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#lrwmjdgnlm .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#lrwmjdgnlm .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#lrwmjdgnlm .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#lrwmjdgnlm .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#lrwmjdgnlm .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#lrwmjdgnlm .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#lrwmjdgnlm .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#lrwmjdgnlm .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#lrwmjdgnlm .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lrwmjdgnlm .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#lrwmjdgnlm .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lrwmjdgnlm .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#lrwmjdgnlm .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#lrwmjdgnlm .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#lrwmjdgnlm .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#lrwmjdgnlm .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#lrwmjdgnlm .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#lrwmjdgnlm .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#lrwmjdgnlm .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#lrwmjdgnlm .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nAIC and BIC values\r\n    Four candidate models: AR(1) ... AR(4)\r\n    model\r\n      AIC\r\n      BIC\r\n    AR(1)\r\n3.80102\r\n3.82630AR(2)\r\n2.91005\r\n2.94376AR(3)\r\n2.91203\r\n2.95418AR(4)\r\n2.91575\r\n2.96632AIC = Akaike information criterion\r\n    BIC = Bayesian information criterion\r\n    \r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-29-bt-pq-p1t220243-aic-and-bic/bt-pq-p1t220243-aic-and-bic_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-01-29T19:58:03-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-29-bt-pq-p1t220242-box-pierce-and-the-ljung-box-tests/",
    "title": "BT PQ P1.T2.20.24.2 Box-Pierce and the Ljung-Box tests",
    "description": "The Box-Pierce statistic is a simplified version of the Ljung-Box statistic; both are joint tests of autocorrelation",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-19",
    "categories": [],
    "contents": "\r\n20.24.2. Elizabeth is an economist tasked with modeling quarterly gross domestic product (GDP) in the United States. She starts with the plots displayed below. The raw data is displayed in the upper; she observes this GDP trend is obviously not stationary (why?). She then performs a typical transformation on the raw data: she takes the difference of the natural log of the quarterly GPD values. This plot is displayed in the lower panel. Because LN[GDP(t)] - LN(GDP(t-1)] = LN[GDP(t)/GDP(t-1)], this lower panel plots continuously compounded returns (aka, monthly log returns). First differencing the log returns occasionally renders the non-stationary trend into a stationary process.\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(scales)\r\nlibrary(forecast)\r\nlibrary(tseries)\r\nlibrary(ggthemes)\r\nlibrary(ggfortify)\r\nlibrary(fpp2)\r\nlibrary(gt)\r\nlibrary(astsa)\r\nlibrary(patchwork)\r\n# library(gridExtra)\r\n\r\ngdp_log <- diff(log(gdp))\r\n\r\n# ts.plot(gdp)\r\n# ts.plot(gdp_log)\r\n\r\np1_gdp <- autoplot(gdp, size = 1.3) + labs(\r\n  title = \"US GDP, Quarterly (billion) 1947 to 2018\"\r\n) + theme_classic() + theme(\r\n  axis.title.x = element_blank(),\r\n  axis.title.y = element_blank(),\r\n  axis.text.x = element_blank(),\r\n  axis.text.y = element_text(size = 11, face = \"bold\")\r\n) + scale_y_continuous(labels = dollar_format())\r\n  \r\np2_gdp_log <- autoplot(gdp_log, size = 1.3) + labs(\r\n  title = bquote(\"LN(\"~GDP[t]~ \") - LN(\"~GDP[t-1]~\")\")\r\n) + theme_classic() + theme(\r\n  axis.title.y = element_blank(),\r\n  axis.text.x = element_text(size = 11, face = \"bold\"),\r\n  axis.text.y = element_text(size = 11, face = \"bold\")\r\n) + scale_y_continuous(labels = label_percent(accuracy = .1))\r\n\r\npatchwork <- p1_gdp / p2_gdp_log\r\npatchwork + plot_annotation(\r\n  caption = \"Source: https://tradingeconomics.com/united-states/gdp (via astsa package)\"\r\n  )\r\n\r\n\r\n\r\n\r\n(on to the Box-Pierce…)\r\nShe then fits an autoregressive, AR(1), and moving average, MA(1), model to the log return series. This gives her three models: the log return series (called “diff_logs”), an AR(1) model, and an MA(1) model. She conducts a Box-Pierce test on each of these models; the test of the AR(1) and MA(1) is a test of the residuals. She selects two lags for the test, h = 10 and h = 20. The results of her Box-Pierce test are displayed below.\r\n… Box-Pierce gt table (below) here …\r\nIf we assume her desired confidence level is 95.0%, which of the following statements is a TRUE statement with respect to an interpretation of her Box-Pierce test of the three models?\r\nNone of the residuals are white noise; i.e., neither the transformed log returns nor AR(1) nor MA(1) is a candidate model\r\nThe AR(1) is a candidate because its residuals appear to be approximately white noise\r\nThe MA(a) is a candidate because its residuals appear to be approximately white noise\r\nAll of the residuals are white noise; i.e., all three models are candidates\r\n\r\n\r\n# install.packages(\"kableExtra\")\r\n# install.packages(\"gapminder\")\r\n\r\nar1_gdp_log <- sarima(gdp_log, p = 1, d = 0, q = 0)\r\n\r\n\r\ninitial  value -4.673186 \r\niter   2 value -4.742918\r\niter   3 value -4.742921\r\niter   4 value -4.742923\r\niter   5 value -4.742925\r\niter   6 value -4.742925\r\niter   6 value -4.742925\r\nfinal  value -4.742925 \r\nconverged\r\ninitial  value -4.742229 \r\niter   2 value -4.742234\r\niter   3 value -4.742245\r\niter   3 value -4.742245\r\niter   3 value -4.742245\r\nfinal  value -4.742245 \r\nconverged\r\n\r\nma1_gdp_log <- sarima(gdp_log, p = 0, d = 0, q = 1)\r\n\r\n\r\ninitial  value -4.672758 \r\niter   2 value -4.716609\r\niter   3 value -4.723220\r\niter   4 value -4.723481\r\niter   5 value -4.723483\r\niter   5 value -4.723483\r\niter   5 value -4.723483\r\nfinal  value -4.723483 \r\nconverged\r\ninitial  value -4.723444 \r\niter   1 value -4.723444\r\nfinal  value -4.723444 \r\nconverged\r\n\r\nma2_gdp_log <- sarima(gdp_log, p = 0, d = 0, q = 2)\r\n\r\n\r\ninitial  value -4.672758 \r\niter   2 value -4.749239\r\niter   3 value -4.750696\r\niter   4 value -4.750723\r\niter   5 value -4.750724\r\niter   6 value -4.750725\r\niter   7 value -4.750725\r\niter   7 value -4.750725\r\niter   7 value -4.750725\r\nfinal  value -4.750725 \r\nconverged\r\ninitial  value -4.751078 \r\niter   2 value -4.751080\r\niter   3 value -4.751080\r\niter   4 value -4.751081\r\niter   5 value -4.751081\r\niter   5 value -4.751081\r\niter   5 value -4.751081\r\nfinal  value -4.751081 \r\nconverged\r\n\r\nh_values <- c(10, 20)\r\n\r\n# diff of logs\r\nmodel = \"diff_logs\"\r\nresults_log_list <- h_values %>% map(~Box.test(gdp_log, lag = .))\r\nlog_statistic <- results_log_list %>% map_dbl(\"statistic\")\r\nlog_p.value <- results_log_list %>% map_dbl(\"p.value\")\r\nlog_cols <- data.frame(cbind(h_values, log_statistic, log_p.value))\r\nlog_all <- cbind(model, log_cols)\r\nlog_all <- log_all %>% rename(\r\n  'h (lags)' = h_values,\r\n  statistic = log_statistic,\r\n  'p-value' = log_p.value\r\n)\r\n\r\n# AR(1)\r\nmodel = \"AR(1)\"\r\nresults_ar1_list <- h_values %>% map(~Box.test(ar1_gdp_log$fit$residuals, lag = .))\r\nar1_statistic <- results_ar1_list %>% map_dbl(\"statistic\")\r\nar1_p.value <- results_ar1_list %>% map_dbl(\"p.value\")\r\nar1_cols <- data.frame(cbind(h_values, ar1_statistic, ar1_p.value))\r\nar1_all <- cbind(model, ar1_cols)\r\nar1_all <- ar1_all %>% rename(\r\n  'h (lags)' = h_values,\r\n  statistic = ar1_statistic,\r\n  'p-value' = ar1_p.value\r\n)\r\n\r\n# MA(1)\r\nmodel = \"MA(1)\"\r\nresults_ma1_list <- h_values %>% map(~Box.test(ma1_gdp_log$fit$residuals, lag = .))\r\nma1_statistic <- results_ma1_list %>% map_dbl(\"statistic\")\r\nma1_p.value <- results_ma1_list %>% map_dbl(\"p.value\")\r\nma1_cols <- data.frame(cbind(h_values, ma1_statistic, ma1_p.value))\r\nma1_all <- cbind(model, ma1_cols)\r\nma1_all <- ma1_all %>% rename(\r\n  'h (lags)' = h_values,\r\n  statistic = ma1_statistic,\r\n  'p-value' = ma1_p.value\r\n)\r\n\r\nmodels_all <- rbind(log_all, ar1_all, ma1_all)\r\nmodels_gt <- gt(models_all)\r\n\r\nmodels_gt <- \r\n  models_gt %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% tab_style(\r\n    style = cell_text(color = \"cadetblue\"),\r\n    locations = cells_column_labels(\r\n      columns = vars(model, 'h (lags)', statistic, 'p-value')\r\n    )\r\n  ) %>% tab_header(\r\n    title = md(\"**Box-Pierce test statistics and p-values**\"),\r\n    subtitle = \"AR(1) and MA(1) at lags of h = 10 and 20\"\r\n  ) %>% fmt_number(\r\n    columns = vars(statistic, 'p-value'),\r\n    decimals = 4\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"Note: diff_logs = LN[GDP(t)] - LN[GPD(t-1)]\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"AR(1) and MA(1) are tests of residuals\")\r\n  ) %>% cols_width(\r\n    vars(model, 'h (lags)') ~ px(80),\r\n    vars(statistic, 'p-value') ~ px(90)\r\n  ) %>% cols_label (\r\n    model = md(\"**model**\"),\r\n    'h (lags)' = md(\"**h (lags)**\"),\r\n    statistic = md(\"**test stat**\"),\r\n    'p-value' = md(\"**p-value**\")\r\n  ) %>% cols_align(\r\n    align = \"center\",\r\n    columns = vars('h (lags)')\r\n  ) %>% tab_options(\r\n    heading.title.font.size = 16,\r\n    heading.subtitle.font.size = 14\r\n  )\r\n\r\nmodels_gt\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#ixmakzggzp .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#ixmakzggzp .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ixmakzggzp .gt_title {\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#ixmakzggzp .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#ixmakzggzp .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#ixmakzggzp .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ixmakzggzp .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#ixmakzggzp .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#ixmakzggzp .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#ixmakzggzp .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#ixmakzggzp .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#ixmakzggzp .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#ixmakzggzp .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#ixmakzggzp .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#ixmakzggzp .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#ixmakzggzp .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#ixmakzggzp .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#ixmakzggzp .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#ixmakzggzp .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#ixmakzggzp .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#ixmakzggzp .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#ixmakzggzp .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#ixmakzggzp .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#ixmakzggzp .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ixmakzggzp .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#ixmakzggzp .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ixmakzggzp .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#ixmakzggzp .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#ixmakzggzp .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#ixmakzggzp .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#ixmakzggzp .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#ixmakzggzp .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#ixmakzggzp .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#ixmakzggzp .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#ixmakzggzp .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nBox-Pierce test statistics and p-values\r\n    AR(1) and MA(1) at lags of h = 10 and 20\r\n    model\r\n      h (lags)\r\n      test stat\r\n      p-value\r\n    diff_logs\r\n10\r\n62.6228\r\n0.0000diff_logs\r\n20\r\n80.1439\r\n0.0000AR(1)\r\n10\r\n15.5465\r\n0.1134AR(1)\r\n20\r\n30.3091\r\n0.0650MA(1)\r\n10\r\n24.3689\r\n0.0067MA(1)\r\n20\r\n39.6618\r\n0.0055Note: diff_logs = LN[GDP(t)] - LN[GPD(t-1)]\r\n    AR(1) and MA(1) are tests of residuals\r\n    \r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-29-bt-pq-p1t220242-box-pierce-and-the-ljung-box-tests/bt-pq-p1t220242-box-pierce-and-the-ljung-box-tests_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-01-29T19:59:14-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-26-bt-pq-p1t22023-set-autoregressive-moving-average-arma-models/",
    "title": "BT PQ P1.T2.20.23 (SET) autoregressive moving average (ARMA) models",
    "description": "ARMA(p,q) combines an AR(p) and MA(q)",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-16",
    "categories": [],
    "contents": "\r\nLearning objectives\r\nExplain mean reversion and calculate a mean-reverting level.\r\nDefine and describe the properties of autoregressive moving average (ARMA) processes.\r\nDescribe the application of AR, MA and ARMA processes.\r\nLet’s load some packages\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(forecast) # incl ggACF()\r\n# library(cowplot)\r\nlibrary(patchwork)\r\n\r\n\r\n\r\n20.23.1. Below are plotted the autocorrelation function (ACF) and partial autocorrelation function (PACF) for a simulated time-series process. Please note that the horizontal dashed blue lines represent the 95.0% confidence interval … Which of the following time-series models is most likely described by these ACF and PACF plots?\r\n\r\n\r\nset.seed(66)\r\n\r\nAR_param_1 = 1.4\r\nAR_param_2 = -0.7\r\nAR_intercept = 0\r\nAR_n <- 1000\r\n\r\ntheme_set(theme_bw())\r\n\r\n# arima.sim model c(p, d, q)\r\n# p = AR order\r\n# d = difference\r\n# q = MA order\r\n# Generate an AR(2) with parameters, AR_param_1 and AR_param_2\r\nAR <- arima.sim(model=list(order=c(2,0,0), ar = c(AR_param_1, AR_param_2)), n = AR_n, mean = AR_intercept)\r\n\r\np3 <- ggAcf(AR) + \r\n  geom_segment(size = 3) +\r\n  labs(\r\n    title = \"autocorrelation function (ACF)\"\r\n  ) + theme(\r\n    plot.title = element_text(size = 12),\r\n    axis.title.x = element_blank(),\r\n    panel.grid = element_blank()\r\n  )\r\np4 <- ggPacf(AR) + \r\n  geom_segment(size = 3) +\r\n  labs(\r\n    title = \"partial autocorrelation function (PACF)\"\r\n  ) + theme(\r\n    plot.title = element_text(size = 12),\r\n    panel.grid = element_blank()\r\n  )\r\n\r\n# Please note plot is shrunk to 86% on copy/paste\r\np3 / p4\r\n\r\n\r\n\r\n\r\n20.23.2. Below are plotted the autocorrelation function (ACF) and partial autocorrelation function (PACF) for a simulated time-series process. Please note that the horizontal dashed blue lines represent the 95.0% confidence interval … Which of the following time-series models is most likely described by these ACF and PACF plots?\r\n\r\n\r\nset.seed(19)\r\n\r\nMA_n = 1000\r\nMA_mean = 0\r\nMA_weight_1 = 0.4\r\nMA_weight_2 = 0.6\r\nMA_weight_3 = 0.8\r\n\r\n# # Generate an MA(3) with weights MA_weight_1, MA_weight_2, and MA_weight_3\r\nMA <- arima.sim(model=list(order = c(0,0,3), ma = c(MA_weight_1, MA_weight_2, MA_weight_3)), n = MA_n, mean = MA_mean)\r\n\r\np5 <- ggAcf(MA) + \r\n  geom_segment(size = 3) +\r\n  # geom_hline(yintercept = c(ci2, -ci2), color = \"darkblue\", linetype = \"dashed\", size = 2 ) +\r\n  labs(\r\n    title = \"autocorrelation function (ACF)\"\r\n  ) + theme(\r\n    plot.title = element_text(size = 12),\r\n    axis.title.x = element_blank(),\r\n    panel.grid = element_blank()\r\n  )\r\np6 <- ggPacf(MA) + \r\n  geom_segment(size = 3) +\r\n  labs(\r\n    title = \"partial autocorrelation function (PACF)\"\r\n  ) + theme(\r\n    plot.title = element_text(size = 12),\r\n    panel.grid = element_blank()\r\n  )\r\n\r\n# Please note plot is shrunk to 86% on copy/paste\r\np5 / p6\r\n\r\n\r\n\r\n\r\n20.23.3. An ARMA(1,1) process evolves according to Y(t) = ẟ + ϕ*Y(t-1) + θ*ε(t-1) + ε(t). The plot below contains two 300-step ARMA(1,1) processes that differ only in their coefficients …\r\nWhich of the following statements is TRUE about the two ARMA(1,1) simulations above?\r\nBoth of the ARMA(1,1) processes are likely to exhibit slow decay in both the ACF and PACF\r\nBoth of the ARMA(1,1) processes are likely to cut off sharply at lag 1 in both the ACF and PACF\r\nThe first ARMA(1,1) process (i.e., plotted with a red dashed line) cannot be covariance-stationary\r\nThe unconditional mean of both ARMA(1,1) processes must be zero because all ARMA(1,1) have a long-run mean of zero\r\n\r\n\r\nlibrary(astsa)\r\nset.seed(9)\r\n\r\nar_11_1 = 0.8\r\nma_11_1 = 0.6\r\narma_11_1_mu = 2\r\nsim_n = 300\r\n\r\nar_11_2 = 0.9\r\nma_11_2 = -0.5\r\narma_11_2_mu = -3\r\n\r\n# ar_22 = c(1.4, -0.6)\r\n# ma_22 = c(0.9, 0.6)\r\n\r\nARMA_11_1 <- arima.sim(model=list(order = c(1, 0, 1), ar = ar_11_1, ma = ma_11_1), n = sim_n) + arma_11_1_mu\r\nARMA_11_2 <- arima.sim(model=list(order = c(1, 0, 1), ar = ar_11_2, ma = ma_11_2), n = sim_n) + arma_11_2_mu\r\n# ARMA_22 <- arima.sim(model=list(order = c(2, 0, 2), ar = ar_22, ma = ma_22), n = 200)\r\n\r\n# ts.plot(ARMA_11, ARMA_22)\r\n\r\ntime_arma <- bind_cols(ARMA_11_1, ARMA_11_2) %>% rowid_to_column() %>% \r\n  rename(y_ARMA_11_1 = ...1, y_ARMA_11_2 = ...2)\r\n\r\n\r\ntheme_set(theme_bw())\r\n\r\ncolors <- c(\"First ARMA(1,1)\" = \"darkred\", \"Second ARMA(1,1)\" = \"steelblue\")\r\n\r\ntime_arma %>% ggplot(aes(x = rowid)) + \r\n  geom_line(aes(y = y_ARMA_11_1, color = \"First ARMA(1,1)\"), size = 1, linetype = \"longdash\") +\r\n  geom_line(aes(y = y_ARMA_11_2, color = \"Second ARMA(1,1)\"), size = 1) +\r\n  scale_y_continuous(labels = scales::number_format(accuracy = 0.1)) + \r\n  theme(\r\n    axis.title.y = element_blank(),\r\n    axis.title.x = element_blank(),\r\n    axis.text.x = element_text(size = 12, face = \"bold\"),\r\n    axis.text.y = element_text(size = 12, face = \"bold\"),\r\n    legend.position = \"right\",\r\n    legend.text = element_text(size = 12)\r\n  ) + labs(\r\n    title = \"Two different ARMA(1,1) time-series simulations\",\r\n    color = \"Legend\"\r\n  ) +\r\n  scale_color_manual(values = colors)\r\n\r\n\r\n\r\narma_11_1_mulr = arma_11_1_mu/(1 - ar_11_1)\r\narma_11_2_mulr = arma_11_2_mu/(1 - ar_11_2)\r\n\r\n# mu_arma_22 = 10\r\n#ARMA_22 <- arima.sim(model=list(order = c(2, 0, 2), ar = c(0.4, 0.2), ma = c(0.5,0.6)), n = 200, mean = mu_arma_22)\r\n# ts.plot(ARMA_22)\r\n# acf2(ARMA_22)\r\n# mean_arma_22 = mu_arma_22/(1 - 0.4 - 0.2)\r\n\r\nacf2(ARMA_11_1)\r\n\r\n\r\n\r\n     [,1]  [,2] [,3]  [,4] [,5] [,6]  [,7]  [,8]  [,9] [,10] [,11]\r\nACF  0.86  0.65 0.50  0.40 0.33 0.29  0.24  0.18  0.11  0.03 -0.05\r\nPACF 0.86 -0.39 0.28 -0.11 0.07 0.05 -0.07 -0.06 -0.01 -0.13 -0.06\r\n     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21]\r\nACF  -0.12 -0.16 -0.17 -0.17 -0.15 -0.12 -0.10 -0.11 -0.13 -0.15\r\nPACF -0.01 -0.03  0.01  0.03  0.06  0.00  0.01 -0.08 -0.03 -0.05\r\n     [,22] [,23] [,24] [,25] [,26] [,27] [,28]\r\nACF  -0.14 -0.08 -0.02  0.03  0.05  0.07  0.11\r\nPACF  0.10  0.06  0.00  0.04 -0.05  0.13  0.07\r\n\r\nacf2(ARMA_11_2)\r\n\r\n\r\n\r\n     [,1] [,2] [,3] [,4] [,5] [,6]  [,7]  [,8]  [,9] [,10] [,11]\r\nACF  0.52 0.45 0.46 0.43 0.37 0.35  0.30  0.25  0.20  0.22  0.16\r\nPACF 0.52 0.24 0.24 0.12 0.05 0.04 -0.02 -0.04 -0.05  0.05 -0.04\r\n     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21]\r\nACF   0.09  0.09  0.10  0.13  0.08  0.09  0.08  0.07  0.05  0.00\r\nPACF -0.08  0.00  0.03  0.10 -0.01  0.04 -0.01  0.01 -0.04 -0.09\r\n     [,22] [,23] [,24] [,25] [,26] [,27] [,28]\r\nACF  -0.04 -0.04 -0.04 -0.08 -0.09 -0.11 -0.14\r\nPACF -0.09 -0.04 -0.01 -0.06  0.00 -0.01 -0.03\r\n\r\nend of post\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-26-bt-pq-p1t22023-set-autoregressive-moving-average-arma-models/bt-pq-p1t22023-set-autoregressive-moving-average-arma-models_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-01-26T12:22:58-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-26-bt-pq-p1t220222-ar-versus-ma-process/",
    "title": "BT PQ P1.T2.20.22.2 autoregressive (AR) versus moving average (MA) process",
    "description": "What's the difference between and AR and MA process, when they appear to be similar?",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-15",
    "categories": [],
    "contents": "\r\nP1.T2.20.22. Stationary Time Series: autoregressive (AR) and moving average (MA) processes\r\nLearning objectives\r\nDefine and describe the properties of autoregressive (AR) processes.\r\nDefine and describe the properties of moving average (MA) processes.\r\nExplain how a lag operator works.\r\n20.22.2. The following code simulates an autoregressive (AR) processes and a moving average (MA) process. The key argument is order=c(p, d, q): p is the AR order (i.e., the number of autoregressive terms), d is the number of nonseasonal differences, and q is the MA order. The “n = 200” argument specifies the length of the simulation. The MA(1) simulation is achieved with c(0, 0, 1) and the AR(1) simulation is achieved with c(1, 0, 0). In both processes, the random shock is white noise: e(t) ~ WN(0, 1) with unit variance.\r\n Below is a plot of the two simulations:\r\n About these AR(1) and MA(1) simulations, each of the following statements is true EXCEPT which is false?\r\n\r\nThe MA(1) process has a mean of 2.0\r\nThe AR(1) process has a long-run (aka, unconditional) mean of 7.50\r\nBoth of these AR(1) and MA(1) processes are covariance-stationary\r\nBoth the these AR(1) and MA(1) processes have unconditional variances of 1.0\r\n\r\n\r\n\r\nlibrary(tidyverse)\r\n\r\nset.seed(25)\r\n\r\nMA_mean = 2.0\r\nMA_weight = 0.5\r\n# Generate an MA(1) with mean, μ = 2.0 and weight parameter 𝜃= 0.5\r\nMA <- arima.sim(model=list(order = c(0,0,1), ma = MA_weight), n = 200, mean = MA_mean)\r\n\r\nAR_intercept = 3.0\r\nAR_param = 0.6\r\n# Generate an AR(1) with intercept δ = 3.0 and AR parameter ϕ = 0.6 \r\nAR <- arima.sim(model=list(order=c(1,0,0), ar = AR_param), n = 200, mean = AR_intercept)\r\n\r\ncolor_AR = \"#266935\"\r\ncolor_MA = \"darkblue\"\r\n\r\ntime_ma_ar <- bind_cols(MA, AR) %>% rowid_to_column() %>% \r\n  rename(y_MA = ...1, y_AR = ...2)\r\ntime_ma_ar %>% ggplot(aes(x = rowid)) + \r\n  theme_bw() + \r\n  theme(\r\n    axis.title.y = element_blank(),\r\n    axis.title.x = element_blank(),\r\n    axis.text = element_text(size = 14, face = \"bold\"),\r\n    legend.position = c(0.8, 0.86)\r\n  ) + \r\n  ggtitle(\"AR(1) series in GREEN. MA(1) series in BLUE.\") + \r\n  geom_line(aes(y = y_AR), color = color_AR, size = 1) +\r\n  geom_line(aes(y = y_MA), color = color_MA, size = 1) +\r\n  scale_y_continuous(breaks = c(0, 2.5, 5.0, 7.5, 10, 12.5))\r\n\r\n\r\n\r\n  # scale_color_manual(name = \"Simulations with arima.sim()\", labels=c(\"MA(1)\", \"AR(1)\"))\r\n\r\n# MA mean is intercept\r\nlr_mean_AR <- AR_intercept/(1 - AR_param)\r\nvariance_MA <- (1 + MA_weight^2)*1\r\nvariance_AR <- 1/(1 - AR_param^2)\r\n\r\nlr_mean_AR\r\n\r\n\r\n[1] 7.5\r\n\r\nvariance_MA\r\n\r\n\r\n[1] 1.25\r\n\r\nvariance_AR\r\n\r\n\r\n[1] 1.5625\r\n\r\nend of post\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-26-bt-pq-p1t220222-ar-versus-ma-process/P1-T2-20-22-2-2-v2.jpg",
    "last_modified": "2022-01-26T12:17:43-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-25-bt-pq-p1t220213-white-noise-wn-process/",
    "title": "BT PQ P1.T2.20.21.3 White Noise (WN) Process",
    "description": "White noise (WN) is the basic time series building block",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-14",
    "categories": [],
    "contents": "\r\nA WN process has three three properties:\r\nzero mean, but note non-zero means are easily transformed\r\nconstant and finte variance\r\n[The critical property] No autocorrelation or autocovariance\r\nBT PQ P1-T2-20-21-3: White Noise (WN) Process)\r\nBT 20.21.3. Barbara was delighted to learn that she can easily simulate white noise in R with a single command. She learned that she can use arima.sim(model = list(order = c(0,0,0)), n = 100) to generate white noise with an ARIMA(0,0,0) model over a length of 100 days. She wants the shocks to have a Poisson distribution so she uses the command arima.sim(model = list(order = c(0,0,0)), n = 100, rand.gen = function(n, …) rpois(n, lambda = 10)) which assumes a Poisson distribution. Below is a plot of the white noise (top panel) and its associated autocorrelation function (ACF, bottom panel).\r\n\r\n\r\n# Simulate a WN model with list(order = c(0, 0, 0))\r\n# white_noise <- arima.sim(model = list(order = c(0,0,0)), n = 100)\r\n# white_noise_1_tb  <- as_tibble(white_noise) %>% rowid_to_column()\r\n# p1 <- ggplot(white_noise_1_tb, aes(x = rowid, y = x)) + geom_line()\r\n# p2 <- ggAcf(white_noise)\r\n# grid.arrange(p1, p2)\r\n\r\nlibrary(tidyverse)\r\nlibrary(forecast)\r\nlibrary(patchwork)\r\nlibrary(extrafont)\r\nlibrary(ggthemes)\r\n# library(ggfortify)\r\n# library(cowplot)\r\n\r\nset.seed(58)\r\n\r\n# Simulate a WN model with list(order = c(0, 0, 0))\r\n# dat_wn <- arima.sim(model = list(order = c(0,0,0)), n = 100)\r\ndat_wn <- arima.sim(model = list(order = c(0,0,0)), n = 100, \r\n                         rand.gen = function(n, ...) rpois(n, lambda = 10))\r\ndat_wn_tbl <- bind_cols(dat_wn) %>% rowid_to_column() %>% rename(value_y = ...1 )\r\n\r\nprocess_color = \"#266935\"\r\np1 <- dat_wn_tbl %>% ggplot(aes(x = rowid, y = value_y)) +\r\n  geom_line(size= 1, color = process_color) +\r\n  ylab(\"Y Value\") +\r\n  xlab(\"Process (100 days)\") + \r\n  theme_bw() + \r\n  theme(\r\n    text = element_text(family = \"Calibri\"),\r\n    plot.title = element_blank(),\r\n    axis.title.x = element_text(size = 14, face = \"bold\"),\r\n    axis.title.y = element_text(size = 14, face = \"bold\", color = process_color),\r\n    axis.text.x = element_text(size = 14, face = \"bold\"),\r\n    axis.text.y = element_text(size = 14, face= \"bold\"),\r\n    panel.background = element_blank(),\r\n    panel.grid.major.x = element_blank(),\r\n    panel.grid.major.y = element_line(color=\"grey\"),\r\n    panel.border = element_blank()\r\n  )\r\n\r\n#p2 <- ggAcf(dat_wn)\r\n\r\np2 <- ggAcf(dat_wn) + \r\n  xlab(\"Lags\") + \r\n  theme_bw() +\r\n  geom_segment(size = 3) +\r\n  theme(\r\n    text = element_text(family = \"Calibri\"),\r\n    plot.title = element_blank(),\r\n    axis.title.x = element_text(size = 14, face = \"bold\"),\r\n    axis.title.y = element_text(size = 14, face = \"bold\"),\r\n    axis.text.x = element_text(size = 14, face = \"bold\"),\r\n    axis.text.y = element_text(size = 14, face= \"bold\"),\r\n    panel.background = element_blank(),\r\n    panel.grid.major.x = element_blank(),\r\n    panel.grid.major.y = element_line(color=\"grey\"),\r\n    panel.border = element_blank()\r\n  )\r\n\r\n\r\n# grid.arrange(p1, p2)\r\n\r\np1/p2\r\n\r\n\r\n\r\ns5 <- arima.sim(model = list(order = c(0,0,0)), n = 100, \r\n                         rand.gen = function(n, ...) rpois(n, lambda = 10))\r\n\r\ndat_rw <- arima.sim(model = list(order = c(0,1,0)), n = 100)\r\ndat_rw_tbl <- bind_cols(dat_rw) %>% rowid_to_column() %>% rename(value_y = ...1 )\r\ndat_rw_tbl %>% ggplot(aes(x = rowid, y = value_y)) + geom_line()\r\n\r\n\r\n\r\n\r\nIs Barbara’s time series model a genuine white noise (WN) process?\r\n\r\nYes, Barbara’s simulation is white noise: although the series has a non-zero mean it can easily be defined in terms of a mean-zero error\r\nYes, Barbara’s simulation is white noise: this series has heteroskedasticity and positive auto-covariance which are both valid features of white noise\r\nNo, Barbara’s simulation is not white noise because white noise must be independent and the lower panel proves this series is not white noise\r\nNo, Barbara’s simulation is not white noise because white noise requires that she assume the distribution function is normal but the shocks in her series are non-normal\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-25-bt-pq-p1t220213-white-noise-wn-process/bt-pq-p1t220213-white-noise-wn-process_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-01-25T18:40:00-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-25-bt-pq-p1t220212-autocorrelation-function-acf/",
    "title": "BT PQ P1.T2.20.21.2 Autocorrelation function (ACF)",
    "description": "The autocorrelation function (ACF; aka, correlogram) plots autocorrelation coefficients",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-13",
    "categories": [],
    "contents": "\r\nBT 20.21.2. Shown below is the autocorrelation function (ACF) for a time series object that contains the total quarterly beer production in Australia (in megalitres) from 1956:Q1 to 2010:Q2 (source: https://cran.r-project.org/web/packages/fpp2/index.html).\r\n\r\n\r\nlibrary(forecast)\r\n# install.packages(\"fpp2\")\r\nlibrary(fpp2)\r\nbeer2 <- ausbeer\r\nbeer2 <- window(ausbeer, start=1992)\r\n\r\nacf_beer2 <- ggAcf(beer2) + \r\n  xlab(\"Lags\") + \r\n  theme_bw() +\r\n  geom_segment(size = 3) +\r\n  theme(\r\n    text = element_text(family = \"Calibri\"),\r\n    plot.title = element_blank(),\r\n    axis.title.x = element_text(size = 14, face = \"bold\"),\r\n    axis.title.y = element_text(size = 14, face = \"bold\"),\r\n    axis.text.x = element_text(size = 14, face = \"bold\"),\r\n    axis.text.y = element_text(size = 14, face= \"bold\"),\r\n    panel.grid.major.x = element_blank(),\r\n    panel.grid.major.y = element_line(color=\"grey\"),\r\n    panel.border = element_blank()\r\n  )\r\n\r\nacf_beer2\r\n\r\n\r\n\r\n\r\nAbout this ACF and its implications, each of the following statements is true EXCEPT which statement is false?\r\n\r\nρ(1) and ρ(3) are insignificant\r\nThis time series is a white noise process\r\nThis ACF is compatible with a seasonal time series\r\nIf this time series exhibits stochastic seasonality, it might be possible to fit a seasonal ARMA model\r\n\r\nEnd of post\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-25-bt-pq-p1t220212-autocorrelation-function-acf/bt-pq-p1t220212-autocorrelation-function-acf_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-01-26T12:20:24-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-25-bt-pq-p1t220203-regression-residual-plost/",
    "title": "BT PQ P1.T2.20.20.3 Regression residual plost",
    "description": "standard lm() diagnostic plots: residual vs fitted, normal Q-Q, scale-location, residuals vs levereage",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-12",
    "categories": [],
    "contents": "\r\nBT Question 20.20.3\r\n20.20.3. Patrick generated a simple regression line for a sample of 50 pairwise observations. After generating the regression model, he ran R’s built-in plot(model) function which produces a standard set of regression diagnostics. These four plots are displayed below.\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(broom)\r\nlibrary(gt)\r\nlibrary(ggrepel)\r\n\r\nintercept <- 4\r\nintercept_sig <- 1\r\n\r\nx1_mu <- 5\r\nx1_sig <- 1\r\nx1_beta <- 0.3\r\n\r\nnoise_mu <- 0\r\nnoise_sig <- 5 # low value gets low p-value b/c low noise\r\n\r\nsize <- 50\r\nset.seed(25)\r\n\r\nrho_noise_x1 <- 0.7\r\n\r\nx1_start = 0\r\nx1_end = 5\r\nx1_step = (x1_end - x1_start)/size\r\n\r\nresults <- tibble(\r\n  x0_sn = rnorm(size),\r\n  x1_sn = rnorm(size),\r\n  x2_sn = rnorm(size), # needed to retain to preserve simulation results!\r\n  e = rnorm(size),\r\n  # \r\n  x0 = intercept + x0_sn * intercept_sig,\r\n  x1 = seq(x1_start, x1_end - x1_step, by = x1_step),\r\n  e_sigma = rpois(size,2), \r\n  x1_b = rep(x1_beta, size),\r\n)\r\n\r\nresults1 <- results %>% mutate(\r\n  y = x0 + (x1_b * x1) + (e * e_sigma)\r\n)\r\n\r\nmodel_1 <- lm(y ~ x1, data = results1)\r\nsummary(model_1)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = y ~ x1, data = results1)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-8.2138 -1.7154 -0.6175  0.8984 11.1858 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)   3.9116     0.9257   4.225 0.000106 ***\r\nx1            0.4636     0.3256   1.424 0.160933    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 3.322 on 48 degrees of freedom\r\nMultiple R-squared:  0.04053,   Adjusted R-squared:  0.02054 \r\nF-statistic: 2.028 on 1 and 48 DF,  p-value: 0.1609\r\n\r\n# model_tidy_1 <- tidy(model_1)\r\n# model_tidy_1[2,1] <- \"Factor\"\r\n\r\n# plot(model_1)\r\n# autoplot(model_1) # + \r\n# geom_text(vjust=-1, label=rownames(results1))\r\n\r\n# mean(results1$y) # price\r\n# mean(results1$x0) # intercept\r\n# mean(results1$x1) # sqfeet\r\n\r\npar(mfrow = c(2,2))\r\nplot(model_1, id.n = 0) \r\n\r\n\r\n\r\n# id.n: number of points to be labelled in each plot, starting with the most extreme.\r\n\r\nmodel_1\r\n\r\n\r\n\r\nCall:\r\nlm(formula = y ~ x1, data = results1)\r\n\r\nCoefficients:\r\n(Intercept)           x1  \r\n     3.9116       0.4636  \r\n\r\nWhat do the plot() diagnostics tell us?\r\nResiduals vs Fitted\r\nThis plots residuals against the fitted values. We would like to see the residuals randomly scattered across the zero (which these are). The scatter pattern is relatively even suggesting homoskedasticity; i.e., we do not see a pattern that suggests heteroskedasticity. There are not many outliers. This is pretty good-looking residuals vs fitted plot suggestive of a decent linear regression.\r\nNormal Q-Q\r\nIf the distribution is normal, the plot will approximate along the straight line. But notice how this plot contains an obvious heavy-tail on the right side.\r\nScale-location\r\nThis plot is similiar to the Residuals vs Fitted plot, but the residuals are standardized. It is also used to evaluate heteroskedasticity. But, again, we do not perceive strong evidence of a non-constant variance.\r\nResiduals vs Leverage\r\nThe red dashed line represents a Cook’s distance of 0.5, but there are not observations outside of this line (i.e., in the upper-left) such that we do not have a case for outlier(s).\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-25-bt-pq-p1t220203-regression-residual-plost/bt-pq-p1t220203-regression-residual-plost_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-01-25T18:05:52-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-24-bt-pq-p1t220202-regression-diagnostics-m-fold-cross-validation-cv/",
    "title": "BT PQ P1.T2.20.20.2 Regression diagnostics: m-fold cross-validation (CV)",
    "description": "m-fold cross validation is for model checking, not model building",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-11",
    "categories": [],
    "contents": "\r\nm-fold cross-validation\r\nOur question P1-T2-20-2 that is located here mimics GARP’s approach in their Chapter 9; in particular their solution 9.14. However, it makes the mistake of using cross-validation to select the regression coefficients. The problem with this approach is simple: the entire dataset is not used to fit the model.\r\nHere are two helpful resources:\r\nIntroduction to Data Science (Data Analysis and Prediction Algorithms with R) by Rafael A. Irizarry at https://rafalab.github.io/dsbook/cross-validation.html#k-fold-cross-validation\r\nThe answer at https://stats.stackexchange.com/questions/52274/how-to-choose-a-predictive-model-after-k-fold-cross-validation\r\nIn the stackexhange Bogdanovist explains that “the purpose of cross-validation is not to come up with our final model. We don’t use these 5 instances of our trained model to do any real prediction. For that we want to use all the data we have to come up with the best model possible. The purpose of cross-validation is model checking, not model building.”\r\nIn this way training different linear regression coefficients is NOT training multiple models. In the example below, there are not three models, there is one model. The one model is the dead-simple univariate regression: lm(Y ~ X, data). The purpose of cross-validation is to estimate the error, it is NOT to calibrate the coefficients by using two-thirds (i.e., 6 of 9) of the dataset.\r\n\r\n\r\nlibrary(tidyverse)\r\n\r\nobs <- tibble(\r\n    X = c(1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00), \r\n    Y = c(2.20, 3.50, 5.20, 2.80, 6.90, 8.80, 5.70, 11.30, 8.60)\r\n)\r\n\r\ntestrows_M1 <- 1:6; testrows_M2 <- 4:9; testrows_M3 <- c(1:3, 7:9)\r\ntrain_M1 <- obs[testrows_M1, ]; test_M1 <- obs[-testrows_M1, ]\r\ntrain_M2 <- obs[testrows_M2, ]; test_M2 <- obs[-testrows_M2, ]\r\ntrain_M3 <- obs[testrows_M3, ]; test_M3 <- obs[-testrows_M3, ]\r\n\r\nmodel_M1 <- lm(Y ~ X, train_M1)\r\nmodel_M2 <- lm(Y ~ X, train_M2)\r\nmodel_M3 <- lm(Y ~ X, train_M3)\r\n\r\npredict_M1 <- predict(model_M1, test_M1, type = \"response\")\r\npredict_M2 <- predict(model_M2, test_M2, type = \"response\")\r\npredict_M3 <- predict(model_M3, test_M3, type = \"response\")\r\n\r\nerror_M1 <- test_M1$Y - predict_M1\r\nerror_M2 <- test_M2$Y - predict_M2\r\nerror_M3 <- test_M3$Y - predict_M3\r\n\r\nCV_RSS_M1 <- sum(error_M1^2) # GARP's selection metric\r\nCV_RSS_M2 <- sum(error_M2^2)\r\nCV_RSS_M3 <- sum(error_M3^2)\r\n\r\ndf <- nrow(obs) - 2 # df = n - k, where k is no. of coefficients\r\n# sample too small, not using\r\n\r\nRMSE_M1 <- sqrt(mean(error_M1^2))\r\nRMSE_M2 <- sqrt(mean(error_M2^2))\r\nRMSE_M3 <- sqrt(mean(error_M3^2))\r\n\r\nRMSE_M1\r\n\r\n\r\n[1] 2.545756\r\n\r\nRMSE_M2\r\n\r\n\r\n[1] 1.350539\r\n\r\nRMSE_M3\r\n\r\n\r\n[1] 1.82291\r\n\r\nlibrary(caret)\r\n\r\nmodel_cv <- train(\r\n  Y ~ X, \r\n  obs,\r\n  method = \"lm\",\r\n  trControl = trainControl(\r\n    method = \"cv\", \r\n    number = 3,\r\n    verboseIter = TRUE\r\n  )\r\n)\r\n\r\n\r\n+ Fold1: intercept=TRUE \r\n- Fold1: intercept=TRUE \r\n+ Fold2: intercept=TRUE \r\n- Fold2: intercept=TRUE \r\n+ Fold3: intercept=TRUE \r\n- Fold3: intercept=TRUE \r\nAggregating results\r\nFitting final model on full training set\r\n\r\n# Notice how caret builds the final regression model on the full dataset. \r\n# CV is to estimate the out-of-sample error; the folded models are \"disposed\"\r\n# We are not REALLY comparing three different models; there is only one model here\r\n# CV is to check the model not build the model\r\n# And intuitively: we want to use all the data to fit the model.\r\n\r\nmodel_cv$finalModel\r\n\r\n\r\n\r\nCall:\r\nlm(formula = .outcome ~ ., data = dat)\r\n\r\nCoefficients:\r\n(Intercept)            X  \r\n     1.4444       0.9333  \r\n\r\nmodel_full <- lm(Y~ X, obs)\r\nmodel_full\r\n\r\n\r\n\r\nCall:\r\nlm(formula = Y ~ X, data = obs)\r\n\r\nCoefficients:\r\n(Intercept)            X  \r\n     1.4444       0.9333  \r\n\r\nBT PQ P1.T2.20.20.2 CV to select best regression model\r\n20.20.2. Patricia needs to specify a regression model, but she is only given nine (Y,X) pairwise observations, as displayed below. She employs m-fold cross-validation (CV) and selects three folds (aka, three blocks). Each of her three candidate regression models is “trained” on two of the folds, so that model can be “tested” on the remaining fold. The first model (M1 in light green) is a regression that is “trained” on the first six observations, and it is given M1: Y1 = 0.820 + 1.166/* X. The second model (M2 in slightly darker green) is a regression that is “trained” on the last six observations, and it is given M2: Y2 = 0.089 + 1.117/* X. The third model (M3 in darkest green) is a regression that is “trained” on the first three and last three observations, and it is given M3: Y3 = 1.1773 + 0.862*X.\r\nm-fold cross-validationFor each model, the residual (i.e., the difference between the predicted and observed Y) is displayed. The final three columns display the squared residuals. If her criteria for model selection follows the principles of m-fold cross-validation then which of the three models should Patricia select?\r\n\r\nShe should select M1 because it has the highest CV RSS\r\nShe should select M2 because it has the lowest CV RSS\r\nShe should select M3 because it has the highest coefficient of determination\r\nShe should select M3 because it has the lowest total RSS\r\n\r\nAnswer here in forum\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-24-bt-pq-p1t220202-regression-diagnostics-m-fold-cross-validation-cv/P1-2-20-20-2-v4.jpg",
    "last_modified": "2022-01-24T10:15:01-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-23-bt-pq-p1t22020-regression-diagnostics-cooks-distance/",
    "title": "BT PQ P1.T2.20.20.1 Regression diagnostics: Cook's distance",
    "description": "Cook's distance evaluates an outlier",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-10",
    "categories": [],
    "contents": "\r\n20.20.1. Below are displayed 15 pairwise (X,Y) trials. The simple regression line based on all 15 observations is given by Y1 = 0.488 + 0.425*X. We consider the possibility that the 12th Trial, given by point (X = 2.50, Y = -3.00) might be an outlier. If this point is removed, then the regression based on the other 14 observations is given by Y2 = 0.761 + 0.574*X. These results are displayed, including selected summary statistics.\r\nCook’s DistanceAccording to Cook’s distance, is the 12th Trial an outlier?\r\n\r\nNo, because its Cook’s distance is negative\r\nNo, because its Cook’s distance is 3.341/(2*1.916) = 0.872\r\nYes, because its Cook’s distance is +0.15 (as given by the slope change)\r\nYes, because its Cook’s distance is 1.916/(2*0.223) = +4.301\r\n\r\nCook’s distance measures the sensitivity of the fitted values to dropping a single observation and is given as follows by D(j)\r\nCook’s Distance formulaIn this case, the numerator is displayed on the given table (i.e., 3.341), and also displayed is the estimate of the error variance, s^2 = 1.916. As this is univariate regression, k = 2 coefficients. The Cook’s distance is therefore given by 3.341/(1.916*2) = 0.872. Because this is less than 1.0, we do not view the 12th trial as an outlier.\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-23-bt-pq-p1t22020-regression-diagnostics-cooks-distance/P1-2-20-20-1-v2.jpg",
    "last_modified": "2022-01-24T09:51:18-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-21-bt-question-set-p1-t2-20-19-regression-diagnostics-set/",
    "title": "BT PQ P1-T2-20-19: Regression diagnostics (SET)",
    "description": "Diagnostics: omitted variable bias, heteroskedasticity, and multicollinearity",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-09",
    "categories": [],
    "contents": "\r\nThree deep FRM PQs that llustrate regression diagnostics\r\nPrecision (reflected by a smaller standard error) refers to dispersion in the sample estimate, while Accuracy is proximity (nearness) to the true population parameter.\r\nHomoskedasticity–a key assumption in the classic linear regression model (CLRM)–requires the conditional variance of the error to be constant. If we regress against a time-ordered variable, homoskedasticity is a constant variance over time (and a requirement of a stationary process). Heteroskedasticity is the violation of homoskedasticity: it is when the conditional variance is not constant. In the time series context, heteroskedasticity is a time-varying variance; i.e., non-constant over time,\r\nWe can test for heteroskedasticity with the White test. Heteroskedasticity is not fatal: the OLS estimators remain linear and remain unbiased however they do not have the minimum variance, so they are not efficient and not BLUE.\r\nMulticollinearity refers to imperfect (aka, near) multicollinearity and is when two or more of the independent variables (regressors) are highly correlated: one of the regressors is highly correlated with (i.e., can itself be explained by) another regressor. Imperfect multicollinearity is generally not a problem because the estimators remain BLUE.\r\nA typical consequence (and telltale indication) of multicollinearity is a high F-statistic but low individual t-statistics. If we observe insignificant regression coefficients (low t-stats) but a significant joint hypothesis (high F-statistic), we can suspect multicollinearity.\r\nOmitted variable bias has two conditions: the omitted (aka, confounding) variable is correlated with the dependent (aka, explained) variable, and is correlated with another independent (aka, regressor) variable. Please notice that simply omitting an independent variable (despite its correlation with the dependent) is insufficient to create omitted variable bias! Why?\r\nCook’s Distance, D(j), measures the impact of an outlier; a D(j) value greater than 1.0 signifies a large impact by the outlier.\r\nQuestion 1: Fama-french 2-factor <- omitted variable\r\n20.19.1. Jane manages a market-neutral equity fund for her investment management firm. The fund’s market-neutral style implies (we will assume) that the fund’s beta with respect to the market’s excess return is zero. However, the fund does seek exposure to other factors. The size factor captures the excess return of small-capitalization stocks (SMB = “small minus big”). Jane tests her portfolio’s exposure to the size factor by regressing the portfolio’s excess return against the size factor returns. Her regression takes the form PORTFOLIO(i) = α + β1×SMB(i) + ε(i). The results of this single-variable (aka, simple) regression are displayed below.\r\n(gt table here)\r\nIn this simple regression, we can observe that SMB’s coefficient is 0.6771 and significant. Jane is concerned that this simple regression might suffer from omitted variable bias. Specifically, she thinks the value factor has been omitted. The value factor captures the excess returns of value stocks (HML = “high book-to-market minus low book-to-market”)’. She confirms that the omitted variable, HML, is associated with her response variable. Further, the omitted variable, HML, is correlated to SMB. The correlation between HML and SMB is 0.30. Jane runs a multivariate regression with both explanatory variables, SMB and HML; in this regression, HML’s beta coefficient is 0.7240 such that the new term is β2×HML(i) = 0.7240×HML(i). Which of the following is nearest to the revised SMB coefficient; i.e., what is the revised β1?\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(broom)\r\nlibrary(gt)\r\n\r\nintercept <- .03\r\nintercept_sig <- .01\r\n\r\n# x1 is market factor\r\nx1_mu <- .05\r\nx1_sig <- .01\r\nx1_beta <- 0.5\r\n\r\n# x2 is size factor\r\nx2_mu <- .04\r\nx2_sig <- .01\r\nx2_beta <- 0.7\r\n\r\n#x3 is value factor\r\nx3_mu <- .03\r\nx3_sig <- .01\r\nx3_beta <- -0.5\r\n\r\nnoise_mu <- 0\r\nnoise_sig <- 0 # low value gets low p-value b/c low noise\r\n\r\nsize <- 120\r\nset.seed(52)\r\n\r\nresults <- tibble(\r\n  x0 = rnorm(size, intercept, intercept_sig),\r\n  x1 = rnorm(size, x1_mu, x1_sig),\r\n  x2 = rnorm(size, x2_mu, x2_sig),\r\n  x2_r = 0.3 * x1 + sqrt(1 - 0.3^2)* x2,\r\n  x3 = rnorm(size, x3_mu, x3_sig),\r\n  x1_b = rep(x1_beta, size),\r\n  x2_b = rep(x2_beta, size),\r\n  x3_b = rep(x3_beta, size),\r\n  noise = rnorm(size, 0, noise_sig)\r\n)\r\n\r\nresults1 <- results %>% mutate(\r\n  y1 = x0 + x1_b * x1 + noise, # market factor only\r\n  y2 = x0 + x1_b * x1 + x2_b * x2_r + noise, # market and size\r\n  y3 = x0 + x1_b * x1 + x2_b * x2 + x3_b * x3 + noise # all three\r\n)\r\n\r\nmodel_y1 <- lm(y2 ~ x1, data = results1) # market only\r\nmodel_y2 <- lm(y2 ~ x1 + x2_r, data = results1) # market and size\r\nmodel_y3 <- lm(y3 ~ x1 + x2 + x3, data = results1)\r\n\r\ncor_x1_x2 <- cor(results1$x1, results1$x2_r)\r\ncov_x1_x2 <- cov(results1$x1, results1$x2_r)\r\nvar_x1 <- var(results1$x1)\r\nvar_x2 <- var(results1$x2_r)\r\nbeta_x1 <- cov_x1_x2/var_x1\r\n\r\nmodel_omit <- lm(x2_r ~ x1, data = results1)\r\n\r\n# model_y1 suffers omitted variable bias: x1 = 0.6771 as given in problem\r\nsummary(model_y1)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = y2 ~ x1, data = results1)\r\n\r\nResiduals:\r\n      Min        1Q    Median        3Q       Max \r\n-0.038216 -0.008610 -0.001528  0.008894  0.033695 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) 0.058839   0.005298  11.105  < 2e-16 ***\r\nx1          0.677063   0.106361   6.366 3.86e-09 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.01155 on 118 degrees of freedom\r\nMultiple R-squared:  0.2556,    Adjusted R-squared:  0.2493 \r\nF-statistic: 40.52 on 1 and 118 DF,  p-value: 3.864e-09\r\n\r\n# And note that \"true\" X1 = 0.463 per the solution's 0.460\r\n# Problem provides rounded 0.7240 as HML coefficient\r\nsummary(model_y2)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = y2 ~ x1 + x2_r, data = results1)\r\n\r\nResiduals:\r\n       Min         1Q     Median         3Q        Max \r\n-0.0221522 -0.0069359  0.0000787  0.0066889  0.0227758 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) 0.030915   0.005373   5.754 7.12e-08 ***\r\nx1          0.463067   0.088293   5.245 7.05e-07 ***\r\nx2_r        0.724203   0.086597   8.363 1.48e-13 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.009173 on 117 degrees of freedom\r\nMultiple R-squared:  0.5341,    Adjusted R-squared:  0.5262 \r\nF-statistic: 67.07 on 2 and 117 DF,  p-value: < 2.2e-16\r\n\r\nmodel_tidy <- tidy(model_y1)\r\nmodel_tidy[2,1] <- \"SMB\"\r\n\r\ngt_table_model <- gt(model_tidy)\r\n\r\ngt_table_model <- \r\n  gt_table_model %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"Market-neutral portfolio excess returns regressed against SMB\",\r\n    subtitle = md(\"(but HML is an ***omitted variable***)\")\r\n  #) %>% tab_source_note(\r\n  #   source_note = md(\"the source is ... FRED\")\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic, p.value),\r\n    decimals = 4\r\n  ) %>% fmt_scientific(\r\n    columns = vars(statistic, p.value),\r\n  ) %>% tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 14\r\n  )\r\n\r\ngt_table_model\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#ecyprinlxi .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#ecyprinlxi .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ecyprinlxi .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#ecyprinlxi .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#ecyprinlxi .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#ecyprinlxi .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ecyprinlxi .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#ecyprinlxi .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#ecyprinlxi .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#ecyprinlxi .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#ecyprinlxi .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#ecyprinlxi .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#ecyprinlxi .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#ecyprinlxi .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#ecyprinlxi .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#ecyprinlxi .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#ecyprinlxi .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#ecyprinlxi .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#ecyprinlxi .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#ecyprinlxi .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#ecyprinlxi .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#ecyprinlxi .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#ecyprinlxi .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#ecyprinlxi .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ecyprinlxi .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#ecyprinlxi .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ecyprinlxi .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#ecyprinlxi .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#ecyprinlxi .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#ecyprinlxi .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#ecyprinlxi .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#ecyprinlxi .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#ecyprinlxi .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#ecyprinlxi .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#ecyprinlxi .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nMarket-neutral portfolio excess returns regressed against SMB\r\n    (but HML is an omitted variable)\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n0.0588\r\n0.0053\r\n1.11 × 101\r\n4.74 × 10−20SMB\r\n0.6771\r\n0.1064\r\n6.37\r\n3.86 × 10−9\r\n\r\nQuestion 2: House Prices - Heteroskedasticity\r\n20.19.2. Josh regressed house prices (as the response or dependent variable) against two explanatory variables: square footage (SQFEET) and the number of rooms in the house (ROOMS). The dependent variable, PRICE, is expressed in thousands of dollars ($000); e.g., the average PRICE is $XXX.000 because the average house price in the sample of 150 houses is $XXX.000. The units of SQFEET are unadjusted units; e.g., the average SQFEET in the sample is X,XXX ft^2. The variable ROOMS is equal to the sum of the number of bedrooms and bathrooms; because much of the sample is 2- and 3-bedroom houses with 2 baths, the average of ROOM is X.XX. Josh’s regression results are displayed below.\r\nJosh is concerned that the data might not be homoscedastic. He decides to conduct a White test for heteroskedasticity. In this test, he regresses the squared residuals against each of the explanatory variables and the cross-product of the explanatory variables (including the product of each variable with itself). The results of this regression are displayed below.\r\n\r\n\r\n# library(tidyverse)\r\n# library(broom)\r\n# library(gt)\r\n\r\nintercept <- 40\r\nintercept_sig <- .01\r\n\r\nx1_mu <- 1000\r\nx1_sig <- 400\r\nx1_beta <- 0.3\r\n\r\nx2_mu <- 4.5\r\nx2_sig <- 2\r\nx2_beta <- 20.0\r\n\r\nnoise_mu <- 0\r\nnoise_sig <- 500 # low value gets low p-value b/c low noise\r\n\r\nsize <- 150\r\nset.seed(65)\r\n\r\nrho_noise_x1 <- 0.7\r\n\r\nft2_start = 800\r\nft2_end = 3000\r\n\r\nresults <- tibble(\r\n  x0_sn = rnorm(size),\r\n  x1_sn = rnorm(size),\r\n  x2_sn = rnorm(size),\r\n  e = rnorm(size),\r\n  # e_corr = rho_noise_x1 * x1_sn + sqrt(1 - rho_noise_x1^2) * noise_sn,\r\n  # \r\n  x0 = intercept + x0_sn * intercept_sig,\r\n  # x1 = x1_mu + x1_sn * x1_sig, \r\n  x1 = seq(ft2_start, ft2_end - 1, by = (ft2_end - ft2_start)/size),\r\n  x2 = x2_mu + x2_sn * x2_sig,\r\n  # \r\n  # here the heteroskadisticity is deliberately introduced:\r\n  # the error term's sigma is increasing with SQFEET, x1\r\n  e_sigma = ((x1 - ft2_start)/100)^2, \r\n  # noise = noise_sn_corr * noise_sig, \r\n  #  \r\n  x1_b = rep(x1_beta, size),\r\n  x2_b = rep(x2_beta, size)\r\n)\r\n\r\nresults1 <- results %>% mutate(\r\n  y = x0 + (x1_b * x1) + (x2_b * x2) + (e * e_sigma)\r\n)\r\n\r\n# cor(results1$e * results1$e_sigma, results1$x1)\r\n\r\nmodel_house <- lm(y ~ x1 + x2, data = results1)\r\nsummary(model_house)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = y ~ x1 + x2, data = results1)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-710.33  -79.41    8.68   61.16  731.16 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) -9.45712   69.59813  -0.136    0.892    \r\nx1           0.36961    0.02734  13.522   <2e-16 ***\r\nx2           8.78355    8.61236   1.020    0.309    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 211.1 on 147 degrees of freedom\r\nMultiple R-squared:  0.5548,    Adjusted R-squared:  0.5488 \r\nF-statistic: 91.61 on 2 and 147 DF,  p-value: < 2.2e-16\r\n\r\nmodel_tidy_house <- tidy(model_house)\r\nmodel_tidy_house[2,1] <- \"SQFEET\"\r\nmodel_tidy_house[3,1] <- \"ROOMS\"\r\n\r\ngt_table_model_house <- gt(model_tidy_house)\r\n\r\ngt_table_model_house <- \r\n  gt_table_model_house %>% \r\n  tab_options(\r\n    table.font.size = 12\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"House Price regressed against ft^2 (SQFEET) + ROOMS(#)\",\r\n    subtitle = md(\"House Price in Thousands **($000)** of dollars\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"Residual standard error: 211.1 on 147 degrees of freedom\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"Multiple R-squared:  0.5548,  Adjusted R-squared:  0.5488\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"F-statistic: 91.61 on 2 and 147 DF,  p-value: < 2.2e-16\")  \r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic, p.value),\r\n    decimals = 3\r\n  ) %>% fmt_scientific(\r\n    columns = vars(p.value),\r\n  ) %>% tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12,\r\n    source_notes.font.size = 12\r\n  )\r\n\r\ngt_table_model_house\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#ptzwsyqmjm .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#ptzwsyqmjm .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ptzwsyqmjm .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#ptzwsyqmjm .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#ptzwsyqmjm .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#ptzwsyqmjm .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ptzwsyqmjm .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#ptzwsyqmjm .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#ptzwsyqmjm .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#ptzwsyqmjm .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#ptzwsyqmjm .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#ptzwsyqmjm .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#ptzwsyqmjm .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#ptzwsyqmjm .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#ptzwsyqmjm .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#ptzwsyqmjm .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#ptzwsyqmjm .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#ptzwsyqmjm .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#ptzwsyqmjm .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#ptzwsyqmjm .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#ptzwsyqmjm .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#ptzwsyqmjm .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#ptzwsyqmjm .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#ptzwsyqmjm .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ptzwsyqmjm .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#ptzwsyqmjm .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#ptzwsyqmjm .gt_sourcenote {\r\n  font-size: 12px;\r\n  padding: 4px;\r\n}\r\n\r\n#ptzwsyqmjm .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#ptzwsyqmjm .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#ptzwsyqmjm .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#ptzwsyqmjm .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#ptzwsyqmjm .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#ptzwsyqmjm .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#ptzwsyqmjm .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#ptzwsyqmjm .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nHouse Price regressed against ft^2 (SQFEET) + ROOMS(#)\r\n    House Price in Thousands ($000) of dollars\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n−9.457\r\n69.598\r\n−0.136\r\n8.92 × 10−1SQFEET\r\n0.370\r\n0.027\r\n13.522\r\n1.40 × 10−27ROOMS\r\n8.784\r\n8.612\r\n1.020\r\n3.09 × 10−1Residual standard error: 211.1 on 147 degrees of freedom\r\n    Multiple R-squared:  0.5548,    Adjusted R-squared:  0.5488\r\n    F-statistic: 91.61 on 2 and 147 DF,  p-value: < 2.2e-16\r\n    \r\n\r\nmean(results1$y) # price\r\n\r\n\r\n[1] 728.2827\r\n\r\nmean(results1$x0) # intercept\r\n\r\n\r\n[1] 39.99987\r\n\r\nmean(results1$x1) # sqfeet\r\n\r\n\r\n[1] 1892.667\r\n\r\nmean(results1$x2) # rooms\r\n\r\n\r\n[1] 4.347188\r\n\r\nressq <- resid(model_house)^2\r\nresults_v2 <- cbind(results1, ressq)\r\nwhite_test <- lm(ressq ~ x1 * x2 + I(x1^2) + I(x2^2), data = results_v2)\r\nsummary(white_test)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = ressq ~ x1 * x2 + I(x1^2) + I(x2^2), data = results_v2)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-163838  -26649   -2683    6834  385087 \r\n\r\nCoefficients:\r\n              Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  1.594e+05  7.490e+04   2.128 0.035015 *  \r\nx1          -1.962e+02  6.936e+01  -2.828 0.005346 ** \r\nx2          -1.578e+04  1.490e+04  -1.059 0.291521    \r\nI(x1^2)      6.017e-02  1.742e-02   3.454 0.000727 ***\r\nI(x2^2)      1.494e+02  1.265e+03   0.118 0.906193    \r\nx1:x2        1.002e+01  4.936e+00   2.030 0.044183 *  \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 76920 on 144 degrees of freedom\r\nMultiple R-squared:  0.3381,    Adjusted R-squared:  0.3152 \r\nF-statistic: 14.71 on 5 and 144 DF,  p-value: 1.201e-11\r\n\r\nwhite_tidy <- tidy(white_test)\r\nwhite_tidy[2,1] <- \"SQFEET\"\r\nwhite_tidy[3,1] <- \"ROOMS\"\r\nwhite_tidy[4,1] <- \"SQFEET^2\"\r\nwhite_tidy[5,1] <- \"ROOMS^2\"\r\nwhite_tidy[6,1] <- \"SQFEET*ROOMS\"\r\n\r\ngt_table_white <- gt(white_tidy)\r\n\r\ngt_table_white <- \r\n  gt_table_white %>% \r\n  tab_options(\r\n    table.font.size = 12,\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"RESIDUAL^2 regressed against SQFEET + ROOMS + SQFEET^2 + ROOMS^2 + ROOMS*SQFEET\",\r\n    subtitle = md(\"White's Test for Heteroskedasticity\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"Residual standard error: 76920 on 144 degrees of freedom\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"Multiple R-squared: 0.3381,  Adjusted R-squared: 0.3152, F-statistic: 14.71 on 5 and 144 DF, p-value: 1.201e-11\")\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic, p.value),\r\n    decimals = 3\r\n  ) %>% fmt_scientific(\r\n     columns = vars(estimate, std.error),\r\n  ) %>% tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12,\r\n    source_notes.font.size = 12\r\n  )\r\n\r\ngt_table_white\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#budlbtjeqa .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#budlbtjeqa .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#budlbtjeqa .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#budlbtjeqa .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#budlbtjeqa .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#budlbtjeqa .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#budlbtjeqa .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#budlbtjeqa .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#budlbtjeqa .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#budlbtjeqa .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#budlbtjeqa .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#budlbtjeqa .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#budlbtjeqa .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#budlbtjeqa .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#budlbtjeqa .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#budlbtjeqa .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#budlbtjeqa .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#budlbtjeqa .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#budlbtjeqa .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#budlbtjeqa .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#budlbtjeqa .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#budlbtjeqa .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#budlbtjeqa .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#budlbtjeqa .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#budlbtjeqa .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#budlbtjeqa .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#budlbtjeqa .gt_sourcenote {\r\n  font-size: 12px;\r\n  padding: 4px;\r\n}\r\n\r\n#budlbtjeqa .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#budlbtjeqa .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#budlbtjeqa .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#budlbtjeqa .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#budlbtjeqa .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#budlbtjeqa .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#budlbtjeqa .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#budlbtjeqa .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nRESIDUAL^2 regressed against SQFEET + ROOMS + SQFEET^2 + ROOMS^2 + ROOMS*SQFEET\r\n    White's Test for Heteroskedasticity\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n1.59 × 105\r\n7.49 × 104\r\n2.128\r\n0.035SQFEET\r\n−1.96 × 102\r\n6.94 × 101\r\n−2.828\r\n0.005ROOMS\r\n−1.58 × 104\r\n1.49 × 104\r\n−1.059\r\n0.292SQFEET^2\r\n6.02 × 10−2\r\n1.74 × 10−2\r\n3.454\r\n0.001ROOMS^2\r\n1.49 × 102\r\n1.27 × 103\r\n0.118\r\n0.906SQFEET*ROOMS\r\n1.00 × 101\r\n4.94\r\n2.030\r\n0.044Residual standard error: 76920 on 144 degrees of freedom\r\n    Multiple R-squared: 0.3381, Adjusted R-squared: 0.3152, F-statistic: 14.71 on 5 and 144 DF, p-value: 1.201e-11\r\n    \r\n\r\n# and the heteroskadisticity is visually VERY obvious!\r\nresults_v2 %>% ggplot(aes(x = x1, y = y)) +\r\n  geom_point()\r\n\r\n\r\n\r\n\r\nQuestion 3: Multicollinearity\r\n20.19.3. Emily works for an insurance company and she has regressed medical costs (aka, the response or dependent variable) for a sample of patients against three independent variables: AGE, BMI, and CHARITY. The sample’s average age is X.X years. Body mass index (BMI) is mass divided by height squared and the sample’s average BMI is X.Y. CHARITY is the dollar amount of charitable spending in the last year; the sample average is $X.Y donated to charity in the last year. Emily’s regression results are displayed below.\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(broom)\r\nlibrary(gt)\r\n\r\nintercept <- 150\r\nintercept_sig <- 40\r\n\r\n# age\r\nx1_mu <- 38\r\nx1_sig <- 7\r\nx1_beta <- 50\r\n\r\n# bmi\r\nx2_mu <- 22\r\nx2_sig <- 4\r\nx2_beta <- 100\r\n\r\n# spend\r\nx3_mu <- 500\r\nx3_sig <- 250\r\nx3_beta <- -0.4\r\n\r\nrho_x1_x2 = 0.3\r\nrho_x1_x3 = 0.97\r\n\r\nnoise_mu <- 0\r\nnoise_sig <- 300 # low value gets low p-value b/c low noise\r\n\r\nsize <- 43\r\nset.seed(12)\r\n\r\nresults <- tibble(\r\n  x0_sn <- rnorm(size),\r\n  x1_sn <- rnorm(size),\r\n  x2_sn <- rnorm(size),\r\n  x3_sn <- rnorm(size),\r\n  #\r\n  x0 = intercept + intercept_sig * x0_sn,\r\n  #\r\n  x1 = x1_mu + x1_sig * x1_sn,\r\n  x2_sn_corr = rho_x1_x2*x1_sn + sqrt(1 - rho_x1_x2^2)*x2_sn,\r\n  x2 = x2_mu + x2_sig * x2_sn_corr,\r\n  x3_sn_corr = rho_x1_x3*x1_sn + sqrt(1 - rho_x1_x3^2)*x3_sn,\r\n  x3 = x3_mu + x3_sig * x3_sn_corr,\r\n  #\r\n  x1_b = rep(x1_beta, size),\r\n  x2_b = rep(x2_beta, size),\r\n  x3_b = rep(x3_beta, size),\r\n  noise = rnorm(size, 0, noise_sig)\r\n)\r\n\r\n\r\nresults1 <- results %>% mutate(\r\n  y = x0 + (x1_b * x1) + (x2_b * x2) + (x3_b * x3) + noise\r\n)\r\n\r\ncor(results1$x1, results1$x3)\r\n\r\n\r\n[1] 0.962464\r\n\r\nmodel <- lm(y ~ x1 + x2 + x3, data = results1)\r\n\r\nmodel_x1 <- lm(x1 ~ x2 + x3, data = results1)\r\nsummary(model_x1)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = x1 ~ x2 + x3, data = results1)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-3.2878 -0.9601 -0.2345  1.1477  3.4376 \r\n\r\nCoefficients:\r\n             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) 24.022184   1.622772  14.803   <2e-16 ***\r\nx2           0.029178   0.072426   0.403    0.689    \r\nx3           0.026997   0.001234  21.883   <2e-16 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 1.733 on 40 degrees of freedom\r\nMultiple R-squared:  0.9266,    Adjusted R-squared:  0.923 \r\nF-statistic: 252.6 on 2 and 40 DF,  p-value: < 2.2e-16\r\n\r\nrsq_x1 <- summary(model_x1)$r.squared\r\n\r\nmodel_x2 <- lm(x2 ~ x1 + x3, data = results1)\r\nsummary(model_x2)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = x2 ~ x1 + x3, data = results1)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-6.9298 -2.1503 -0.5579  2.5672  7.9527 \r\n\r\nCoefficients:\r\n              Estimate Std. Error t value Pr(>|t|)  \r\n(Intercept) 16.9897894  8.5885276   1.978   0.0548 .\r\nx1           0.1384986  0.3437854   0.403   0.6892  \r\nx3          -0.0001614  0.0096805  -0.017   0.9868  \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 3.776 on 40 degrees of freedom\r\nMultiple R-squared:  0.04833,   Adjusted R-squared:  0.0007499 \r\nF-statistic: 1.016 on 2 and 40 DF,  p-value: 0.3713\r\n\r\nrsq_x2 <- summary(model_x2)$r.squared\r\n\r\nmodel_x3 <- lm(x3 ~ x1 + x2, data = results1)\r\nsummary(model_x3)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = x3 ~ x1 + x2, data = results1)\r\n\r\nResiduals:\r\n     Min       1Q   Median       3Q      Max \r\n-119.098  -39.213    9.803   48.540   99.936 \r\n\r\nCoefficients:\r\n              Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) -802.99922   74.04616 -10.845 1.77e-13 ***\r\nx1            34.18590    1.56221  21.883  < 2e-16 ***\r\nx2            -0.04306    2.58249  -0.017    0.987    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 61.67 on 40 degrees of freedom\r\nMultiple R-squared:  0.9263,    Adjusted R-squared:  0.9227 \r\nF-statistic: 251.5 on 2 and 40 DF,  p-value: < 2.2e-16\r\n\r\nrsq_x3 <- summary(model_x3)$r.squared\r\n\r\nvar_if_x1 <- 1/(1 - rsq_x1 )\r\nvar_if_x2 <- 1/(1 - rsq_x2)\r\nvar_if_x3 <- 1/(1 - rsq_x3)\r\n\r\nmulti_table <- tibble(\r\n  regression = c(1,2,3),\r\n  response = c(\"AGE\", \"BMI\", \"CHARITY\"),\r\n  explanatory = c(\"BMI + CHARITY\", \"AGE + CHARITY\", \"AGE + BMI\"),\r\n  Rsquared = c(rsq_x1, rsq_x2, rsq_x3)\r\n)\r\n\r\n\r\nmodel_tidy <- tidy(model)\r\nmodel_tidy[2,1] <- \"AGE\"\r\nmodel_tidy[3,1] <- \"BMI\"\r\nmodel_tidy[4,1] <- \"CHARITY\"\r\n\r\ngt_table_model <- gt(model_tidy)\r\n\r\ngt_table_model <- \r\n  gt_table_model %>% \r\n  tab_options(\r\n    table.font.size = 12\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"Medical COST regressed against AGE + BMI + CHARITY($)\",\r\n    subtitle = md(\"Simulated data\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"Residual standard error: 325.1 on 39 degrees of freedom\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"Multiple R-squared: 0.6961,  Adjusted R-squared: 0.6727, F-statistic: 29.77 on 3 and 39 DF, p-value: 3.514e-10\")\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic, p.value),\r\n    decimals = 2\r\n  ) %>% fmt_scientific(\r\n    columns = vars(p.value),\r\n  ) %>% tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12,\r\n     source_notes.font.size = 12\r\n  )\r\n\r\n##\r\n\r\ngt_multi_table <- gt(multi_table)\r\n\r\ngt_multi_table <- \r\n  gt_multi_table %>% \r\n  tab_options(\r\n    table.font.size = 12\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"Each response variable regressed against the others\",\r\n    subtitle = md(\"Testing for multicollinearity\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"Note: According to GARP, the standard test of\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"multicollinearity is the variance inflation factor (VIF)\")\r\n  ) %>% cols_label(\r\n    regression = \"Regression\",\r\n    response = \"Response\",\r\n    explanatory = \"Explanatory\",\r\n    Rsquared = \"R-squared\",\r\n  ) %>% cols_align(\r\n    align = \"center\",\r\n    columns = vars(regression)\r\n  ) %>% fmt_number(\r\n    columns = vars(Rsquared),\r\n    decimals = 3\r\n  # ) %>% fmt_scientific(\r\n    # columns = vars(p.value),\r\n  ) %>% tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12,\r\n     source_notes.font.size = 12\r\n  )\r\n\r\nsummary(model)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = y ~ x1 + x2 + x3, data = results1)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-923.93 -243.27   21.75  192.64  554.97 \r\n\r\nCoefficients:\r\n             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) -165.2505   774.7267  -0.213   0.8322    \r\nx1            63.6695    29.6571   2.147   0.0381 *  \r\nx2           102.4645    13.6123   7.527 4.09e-09 ***\r\nx3            -0.9461     0.8334  -1.135   0.2632    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 325.1 on 39 degrees of freedom\r\nMultiple R-squared:  0.6961,    Adjusted R-squared:  0.6727 \r\nF-statistic: 29.77 on 3 and 39 DF,  p-value: 3.514e-10\r\n\r\nsummary(multi_table)\r\n\r\n\r\n   regression    response         explanatory       \r\n Min.   :1.0   Length:3           Length:3          \r\n 1st Qu.:1.5   Class :character   Class :character  \r\n Median :2.0   Mode  :character   Mode  :character  \r\n Mean   :2.0                                        \r\n 3rd Qu.:2.5                                        \r\n Max.   :3.0                                        \r\n    Rsquared      \r\n Min.   :0.04833  \r\n 1st Qu.:0.48734  \r\n Median :0.92634  \r\n Mean   :0.63377  \r\n 3rd Qu.:0.92649  \r\n Max.   :0.92663  \r\n\r\ngt_table_model\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#lqqjmyauaw .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#lqqjmyauaw .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lqqjmyauaw .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#lqqjmyauaw .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#lqqjmyauaw .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#lqqjmyauaw .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lqqjmyauaw .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#lqqjmyauaw .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#lqqjmyauaw .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#lqqjmyauaw .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#lqqjmyauaw .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#lqqjmyauaw .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#lqqjmyauaw .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#lqqjmyauaw .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#lqqjmyauaw .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#lqqjmyauaw .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#lqqjmyauaw .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#lqqjmyauaw .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#lqqjmyauaw .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#lqqjmyauaw .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#lqqjmyauaw .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#lqqjmyauaw .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#lqqjmyauaw .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#lqqjmyauaw .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lqqjmyauaw .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#lqqjmyauaw .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lqqjmyauaw .gt_sourcenote {\r\n  font-size: 12px;\r\n  padding: 4px;\r\n}\r\n\r\n#lqqjmyauaw .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#lqqjmyauaw .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#lqqjmyauaw .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#lqqjmyauaw .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#lqqjmyauaw .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#lqqjmyauaw .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#lqqjmyauaw .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#lqqjmyauaw .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nMedical COST regressed against AGE + BMI + CHARITY($)\r\n    Simulated data\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n−165.25\r\n774.73\r\n−0.21\r\n8.32 × 10−1AGE\r\n63.67\r\n29.66\r\n2.15\r\n3.81 × 10−2BMI\r\n102.46\r\n13.61\r\n7.53\r\n4.09 × 10−9CHARITY\r\n−0.95\r\n0.83\r\n−1.14\r\n2.63 × 10−1Residual standard error: 325.1 on 39 degrees of freedom\r\n    Multiple R-squared: 0.6961, Adjusted R-squared: 0.6727, F-statistic: 29.77 on 3 and 39 DF, p-value: 3.514e-10\r\n    \r\n\r\ngt_multi_table\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#gphnlsqzwo .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#gphnlsqzwo .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#gphnlsqzwo .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#gphnlsqzwo .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#gphnlsqzwo .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#gphnlsqzwo .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#gphnlsqzwo .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#gphnlsqzwo .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#gphnlsqzwo .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#gphnlsqzwo .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#gphnlsqzwo .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#gphnlsqzwo .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#gphnlsqzwo .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#gphnlsqzwo .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#gphnlsqzwo .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#gphnlsqzwo .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#gphnlsqzwo .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#gphnlsqzwo .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#gphnlsqzwo .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#gphnlsqzwo .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#gphnlsqzwo .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#gphnlsqzwo .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#gphnlsqzwo .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#gphnlsqzwo .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#gphnlsqzwo .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#gphnlsqzwo .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#gphnlsqzwo .gt_sourcenote {\r\n  font-size: 12px;\r\n  padding: 4px;\r\n}\r\n\r\n#gphnlsqzwo .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#gphnlsqzwo .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#gphnlsqzwo .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#gphnlsqzwo .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#gphnlsqzwo .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#gphnlsqzwo .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#gphnlsqzwo .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#gphnlsqzwo .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nEach response variable regressed against the others\r\n    Testing for multicollinearity\r\n    Regression\r\n      Response\r\n      Explanatory\r\n      R-squared\r\n    1\r\nAGE\r\nBMI + CHARITY\r\n0.9272\r\nBMI\r\nAGE + CHARITY\r\n0.0483\r\nCHARITY\r\nAGE + BMI\r\n0.926Note: According to GARP, the standard test of\r\n    multicollinearity is the variance inflation factor (VIF)\r\n    \r\n\r\nmean(results1$y) # cost\r\n\r\n\r\n[1] 4079.452\r\n\r\nmean(results1$x0) # intercept\r\n\r\n\r\n[1] 145.2152\r\n\r\nmean(results1$x1) # age\r\n\r\n\r\n[1] 38.48411\r\n\r\nmean(results1$x2) # bmi\r\n\r\n\r\n[1] 22.2372\r\n\r\nmean(results1$x3) # spend\r\n\r\n\r\n[1] 511.6571\r\n\r\n# let's see the VIFs\r\nvar_if_x1\r\n\r\n\r\n[1] 13.63041\r\n\r\nvar_if_x2\r\n\r\n\r\n[1] 1.050788\r\n\r\nvar_if_x3\r\n\r\n\r\n[1] 13.57542\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-21-bt-question-set-p1-t2-20-19-regression-diagnostics-set/P1-T2-20-19-2Q2-v2.jpg",
    "last_modified": "2022-01-30T18:04:55-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-17-bt-question-set-p1-t2-20-18-multivariate-regressions/",
    "title": "BT PQ P1-T2-20-18 (SET) Multivariate regressions",
    "description": "Fama-French three-factor model; House prices; and Medical costs",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-08",
    "categories": [],
    "contents": "\r\nMultiple regression\r\nIn each exercise, the values aspire to be realistic but, becasue I wanted to test for specific items, the datasets are simulated.\r\nQuestion 1: Fama-french\r\n20.18.1. Sally is a portfolio manager at an investment management firm. She wants to test her primary equity portfolio’s reaction to the factors in the Fama-French three-factor model. She collected excess returns (i.e., net of the riskfree rate) over the last eight years, so that the sample size, n = 96 months. The response (aka, explained, dependent) variable is the portfolio’s excess return. The three explanatory variables are the market factor (MKT), the size factor (SMB), and the value factor (HML). The size factor captures the excess return of small capitalization stocks (SMB = “small minus big”) and the value factor captures the excess returns of value stocks (HML = “high book-to-market minus low book-to-market”). Sally’s regression results are displayed below.\r\n(regression table here)\r\nWhich of the following descriptions of her portfolio is the most accurate?\r\nHer small capitalization, value-oriented low-beta portfolio has not generated alpha\r\nHer large capitalization, growth-oriented high-beta portfolio has not generated alpha\r\nHer large capitalization, growth-oriented low-beta portfolio has generated significantly positive alpha\r\nHer small capitalization, value-oriented high-beta portfolio has generated significantly positive alpha\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(broom)\r\nlibrary(gt)\r\n\r\nintercept <- .03\r\nintercept_sig <- .01\r\n\r\nx1_mu <- .04\r\nx1_sig <- .01\r\nx1_beta <- 0.4\r\n\r\nx2_mu <- .03\r\nx2_sig <- .01\r\nx2_beta <- -0.6\r\n\r\nx3_mu <- .03\r\nx3_sig <- .01\r\nx3_beta <- -0.3\r\n\r\nnoise_mu <- 0\r\nnoise_sig <- 0 # low value gets low p-value b/c low noise\r\n\r\nsize <- 96\r\nset.seed(18)\r\n\r\nresults <- tibble(\r\n  x0 = rnorm(size, intercept, intercept_sig),\r\n  x1 = rnorm(size, x1_mu, x1_sig),\r\n  x2 = rnorm(size, x2_mu, x2_sig),\r\n  x3 = rnorm(size, x3_mu, x3_sig),\r\n  x1_b = rep(x1_beta, size),\r\n  x2_b = rep(x2_beta, size),\r\n  x3_b = rep(x3_beta, size),\r\n  noise = rnorm(size, 0, noise_sig)\r\n)\r\n\r\n\r\nresults1 <- results %>% mutate(\r\n  y = x0 +x1_b * x1 + x2_b * x2 + x3_b * x3 + noise\r\n)\r\n\r\nmodel <- lm(y ~ x1 + x2 + x3, data = results1)\r\nsummary(model)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = y ~ x1 + x2 + x3, data = results1)\r\n\r\nResiduals:\r\n       Min         1Q     Median         3Q        Max \r\n-0.0179934 -0.0063017 -0.0002194  0.0069123  0.0252648 \r\n\r\nCoefficients:\r\n             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  0.026900   0.005785   4.650 1.11e-05 ***\r\nx1           0.501752   0.099805   5.027 2.44e-06 ***\r\nx2          -0.702932   0.096522  -7.283 1.09e-10 ***\r\nx3          -0.276534   0.102339  -2.702   0.0082 ** \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.00983 on 92 degrees of freedom\r\nMultiple R-squared:  0.4619,    Adjusted R-squared:  0.4444 \r\nF-statistic: 26.33 on 3 and 92 DF,  p-value: 2.206e-12\r\n\r\nmodel_tidy <- tidy(model)\r\nmodel_tidy[2,1] <- \"MKT\"\r\nmodel_tidy[3,1] <- \"SMB\"\r\nmodel_tidy[4,1] <- \"HML\"\r\n\r\ngt_table_model <- gt(model_tidy)\r\n\r\ngt_table_model <- \r\n  gt_table_model %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"Portfolio excess returns regressed against MKT + SMB + HML\",\r\n    subtitle =\"i.e., Fama-French three-factor model\"\r\n  #) %>% tab_source_note(\r\n  #   source_note = md(\"the source is ... FRED\")\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic, p.value),\r\n    decimals = 3\r\n  ) %>% fmt_scientific(\r\n    columns = vars(statistic, p.value),\r\n  ) %>% tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12\r\n  )\r\n\r\ngt_table_model\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#pgiqepqpuz .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#pgiqepqpuz .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#pgiqepqpuz .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#pgiqepqpuz .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#pgiqepqpuz .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#pgiqepqpuz .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#pgiqepqpuz .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#pgiqepqpuz .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#pgiqepqpuz .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#pgiqepqpuz .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#pgiqepqpuz .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#pgiqepqpuz .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#pgiqepqpuz .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#pgiqepqpuz .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#pgiqepqpuz .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#pgiqepqpuz .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#pgiqepqpuz .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#pgiqepqpuz .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#pgiqepqpuz .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#pgiqepqpuz .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#pgiqepqpuz .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#pgiqepqpuz .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#pgiqepqpuz .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#pgiqepqpuz .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#pgiqepqpuz .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#pgiqepqpuz .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#pgiqepqpuz .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#pgiqepqpuz .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#pgiqepqpuz .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#pgiqepqpuz .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#pgiqepqpuz .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#pgiqepqpuz .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#pgiqepqpuz .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#pgiqepqpuz .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#pgiqepqpuz .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nPortfolio excess returns regressed against MKT + SMB + HML\r\n    i.e., Fama-French three-factor model\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n0.027\r\n0.006\r\n4.65\r\n1.11 × 10−5MKT\r\n0.502\r\n0.100\r\n5.03\r\n2.44 × 10−6SMB\r\n−0.703\r\n0.097\r\n−7.28\r\n1.09 × 10−10HML\r\n−0.277\r\n0.102\r\n−2.70\r\n8.20 × 10−3\r\n\r\nQuestion 2: House Prices\r\n20.18.2. Derek regressed house prices (as the response or dependent variable) against three explanatory variables: square footage (SQFEET), number of rooms in the house (ROOMS), and age of the house (AGE). The dependent variable, PRICE, is expressed in thousands of dollars ($000); e.g., the average PRICE is $386.051 because the average house price in the sample of 96 houses is $386,051. The units of SQFEET are unadjusted units; e.g., the average SQFEET in the sample is 1,203 ft^2. The variable ROOMS is equal to the sum of the number of bedrooms and bathrooms; because much of the sample is 2- and 3-bedroom houses with 2 baths, the average of ROOM is 4.55. Finally, AGE is given in years where the average AGE in the sample is 14.77 years. Derek’s regression results are displayed below.\r\n(regression table here)\r\nEach of the following statements is true about these regression results EXCEPT which is false?\r\nOlder houses have lower prices on average\r\nThe 98.0% confidence interval (CI) for the AGE coefficient is (5.7, 10.4)\r\nThe 90.0% confidence interval (CI) for the ROOMS coefficient is (8.1, 10.9)\r\nAn additional (+) 100 square feet (ft^2) is associated with an expected increase of ~ $29,100 in the price of the house\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(broom)\r\nlibrary(gt)\r\n\r\nintercept <- 40\r\nintercept_sig <- .01\r\n\r\nx1_mu <- 1200\r\nx1_sig <- 30\r\nx1_beta <- 0.35\r\n\r\nx2_mu <- 4.5\r\nx2_sig <- 2\r\nx2_beta <- 10.0\r\n\r\nx3_mu <- 15\r\nx3_sig <- 4\r\nx3_beta <- -8.0\r\n\r\nnoise_mu <- 0\r\nnoise_sig <- 20 # low value gets low p-value b/c low noise\r\n\r\nsize <- 96\r\nset.seed(43)\r\n\r\nresults <- tibble(\r\n  x0 = rnorm(size, intercept, intercept_sig),\r\n  x1 = rnorm(size, x1_mu, x1_sig),\r\n  x2 = rnorm(size, x2_mu, x2_sig),\r\n  x3 = rnorm(size, x3_mu, x3_sig),\r\n  x1_b = rep(x1_beta, size),\r\n  x2_b = rep(x2_beta, size),\r\n  x3_b = rep(x3_beta, size),\r\n  noise = rnorm(size, 0, noise_sig)\r\n)\r\n\r\n\r\nresults1 <- results %>% mutate(\r\n  y = x0 +x1_b * x1 + x2_b * x2 + x3_b * x3 + noise\r\n)\r\n\r\nmodel <- lm(y ~ x1 + x2 + x3, data = results1)\r\nsummary(model)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = y ~ x1 + x2 + x3, data = results1)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-40.088 -13.508  -1.795  13.819  41.934 \r\n\r\nCoefficients:\r\n             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) 110.95667   76.98277   1.441    0.153    \r\nx1            0.29138    0.06283   4.638 1.16e-05 ***\r\nx2            9.53971    0.85291  11.185  < 2e-16 ***\r\nx3           -8.06268    0.48275 -16.702  < 2e-16 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 18.28 on 92 degrees of freedom\r\nMultiple R-squared:  0.8378,    Adjusted R-squared:  0.8325 \r\nF-statistic: 158.4 on 3 and 92 DF,  p-value: < 2.2e-16\r\n\r\nmodel_tidy <- tidy(model)\r\nmodel_tidy[2,1] <- \"SQFEET\"\r\nmodel_tidy[3,1] <- \"ROOMS\"\r\nmodel_tidy[4,1] <- \"AGE\"\r\n\r\ngt_table_model <- gt(model_tidy)\r\n\r\ngt_table_model <- \r\n  gt_table_model %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"House Price regressed against ft^2 (SQFEET) + ROOMS(#) + AGE(years)\",\r\n    subtitle = md(\"House Price in Thousands **($000)** of dollars\")\r\n  #) %>% tab_source_note(\r\n  #   source_note = md(\"the source is ... FRED\")\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic, p.value),\r\n    decimals = 3\r\n  ) %>% fmt_scientific(\r\n    columns = vars(p.value),\r\n  ) %>% tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12\r\n  )\r\n\r\ngt_table_model\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#vghvnzctdm .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#vghvnzctdm .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#vghvnzctdm .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#vghvnzctdm .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#vghvnzctdm .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#vghvnzctdm .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#vghvnzctdm .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#vghvnzctdm .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#vghvnzctdm .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#vghvnzctdm .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#vghvnzctdm .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#vghvnzctdm .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#vghvnzctdm .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#vghvnzctdm .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#vghvnzctdm .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#vghvnzctdm .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#vghvnzctdm .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#vghvnzctdm .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#vghvnzctdm .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#vghvnzctdm .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#vghvnzctdm .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#vghvnzctdm .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#vghvnzctdm .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#vghvnzctdm .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#vghvnzctdm .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#vghvnzctdm .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#vghvnzctdm .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#vghvnzctdm .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#vghvnzctdm .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#vghvnzctdm .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#vghvnzctdm .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#vghvnzctdm .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#vghvnzctdm .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#vghvnzctdm .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#vghvnzctdm .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nHouse Price regressed against ft^2 (SQFEET) + ROOMS(#) + AGE(years)\r\n    House Price in Thousands ($000) of dollars\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n110.957\r\n76.983\r\n1.441\r\n1.53 × 10−1SQFEET\r\n0.291\r\n0.063\r\n4.638\r\n1.16 × 10−5ROOMS\r\n9.540\r\n0.853\r\n11.185\r\n7.64 × 10−19AGE\r\n−8.063\r\n0.483\r\n−16.702\r\n1.33 × 10−29\r\n\r\nmean(results1$y) # price\r\n\r\n\r\n[1] 386.051\r\n\r\nmean(results1$x0) # intercept\r\n\r\n\r\n[1] 40.0002\r\n\r\nmean(results1$x1) # sqfeet\r\n\r\n\r\n[1] 1203.809\r\n\r\nmean(results1$x2) # rooms\r\n\r\n\r\n[1] 4.548471\r\n\r\nmean(results1$x3) # age\r\n\r\n\r\n[1] 14.76695\r\n\r\nQuestion 3: Insurance\r\n20.18.3. Mary works for an insurance company and she has regressed medical costs (aka, the response or dependent variable) for a sample of patients against four independent variables: AGE, BMI, SMOKER, and CHARITY. The sample’s average age is 38.51 years. Body mass index (BMI) is mass divided by height squared and the sample’s average BMI is 22.16. SMOKER is a dummy variable where zero indicates a non-smoker and 1 indicates a smoker; the sample’s average SMOKER value is 0.163 which indicates that 16.3% of the sample are smokers. CHARITY is the dollar amount of charitable spending in the last year; the sample average is $490.70 donated to charity in the last year. Mary’s regression results are displayed below.\r\n(regression table here)\r\nEach of the following statements is true about these regression results EXCEPT which is false?\r\nThe sample size is 43 patients\r\nMary can reject a null hypothesis that all explanatory variables (jointly) have zero coefficients\r\nMary can infer that patient medical cost is positively associated with each of AGE, BMI, and, on average, is greater for a smoker\r\nMary should suspect problematic multicollinearity because the intercept is suspiciously negative and the adjusted R-squared is too near to the unadjusted R-squared\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(broom)\r\nlibrary(gt)\r\n\r\nintercept <- 150\r\nintercept_sig <- 40\r\n\r\n# age\r\nx1_mu <- 38\r\nx1_sig <- 7\r\nx1_beta <- 50\r\n\r\n# bmi\r\nx2_mu <- 22\r\nx2_sig <- 4\r\nx2_beta <- 100\r\n\r\n# smoker\r\nx3_mu <- 15\r\nx3_sig <- 0.5\r\nx3_beta <- 535\r\n\r\n# spend\r\nx4_mu <- 500\r\nx4_sig <- 250\r\nx4_beta <- -0.4\r\n\r\n\r\nnoise_mu <- 0\r\nnoise_sig <- 300 # low value gets low p-value b/c low noise\r\n\r\nsize <- 43\r\nset.seed(12)\r\n\r\nresults <- tibble(\r\n  x0 = rnorm(size, intercept, intercept_sig),\r\n  x1 = round(rnorm(size, x1_mu, x1_sig)),\r\n  x2 = rnorm(size, x2_mu, x2_sig),\r\n  x3 = round(runif(size)-.35), # smoker = 1, non = 0\r\n  x4 = rnorm(size, x4_mu, x4_sig),\r\n  x1_b = rep(x1_beta, size),\r\n  x2_b = rep(x2_beta, size),\r\n  x3_b = rep(x3_beta, size),\r\n  x4_b = rep(x4_beta, size),\r\n  noise = rnorm(size, 0, noise_sig)\r\n)\r\n\r\n\r\nresults1 <- results %>% mutate(\r\n  y = x0 +x1_b * x1 + x2_b * x2 + x3_b * x3 + x4_b * x4 + noise\r\n)\r\n\r\nmodel <- lm(y ~ x1 + x2 + x3 + x4, data = results1)\r\nsummary(model)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = y ~ x1 + x2 + x3 + x4, data = results1)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-635.96 -169.65   15.59  219.73  543.51 \r\n\r\nCoefficients:\r\n             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) -324.2133   415.7736  -0.780 0.440348    \r\nx1            56.9518     7.5517   7.542 4.60e-09 ***\r\nx2           111.7571    11.9374   9.362 2.06e-11 ***\r\nx3           454.0799   125.8293   3.609 0.000884 ***\r\nx4            -0.5485     0.1793  -3.058 0.004064 ** \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 298.3 on 38 degrees of freedom\r\nMultiple R-squared:  0.8215,    Adjusted R-squared:  0.8027 \r\nF-statistic: 43.71 on 4 and 38 DF,  p-value: 1.009e-13\r\n\r\nmodel_tidy <- tidy(model)\r\nmodel_tidy[2,1] <- \"AGE\"\r\nmodel_tidy[3,1] <- \"BMI\"\r\nmodel_tidy[4,1] <- \"SMOKER\"\r\nmodel_tidy[5,1] <- \"CHARITY\"\r\n\r\ngt_table_model <- gt(model_tidy)\r\n\r\ngt_table_model <- \r\n  gt_table_model %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"Medical COST regressed against AGE + BMI + SMOKER(1/0) + CHARITY($)\",\r\n    subtitle = md(\"Simulated dataset\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"Residual standard error: 295.2 on 38 degrees of freedom\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"Multiple R-squared:  0.8343,  Adjusted R-squared:  0.8168\")\r\n  ) %>% tab_source_note(\r\n    source_note = md(\"F-statistic: 47.82 on 4 and 38 DF,  p-value: 2.486e-14\")\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic, p.value),\r\n    decimals = 2\r\n  ) %>% fmt_scientific(\r\n    columns = vars(p.value),\r\n  ) %>% tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12\r\n  )\r\n\r\n\r\ngt_table_model\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#iwuuabqqil .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#iwuuabqqil .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#iwuuabqqil .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#iwuuabqqil .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#iwuuabqqil .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#iwuuabqqil .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#iwuuabqqil .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#iwuuabqqil .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#iwuuabqqil .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#iwuuabqqil .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#iwuuabqqil .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#iwuuabqqil .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#iwuuabqqil .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#iwuuabqqil .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#iwuuabqqil .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#iwuuabqqil .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#iwuuabqqil .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#iwuuabqqil .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#iwuuabqqil .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#iwuuabqqil .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#iwuuabqqil .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#iwuuabqqil .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#iwuuabqqil .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#iwuuabqqil .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#iwuuabqqil .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#iwuuabqqil .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#iwuuabqqil .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#iwuuabqqil .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#iwuuabqqil .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#iwuuabqqil .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#iwuuabqqil .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#iwuuabqqil .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#iwuuabqqil .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#iwuuabqqil .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#iwuuabqqil .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nMedical COST regressed against AGE + BMI + SMOKER(1/0) + CHARITY($)\r\n    Simulated dataset\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n−324.21\r\n415.77\r\n−0.78\r\n4.40 × 10−1AGE\r\n56.95\r\n7.55\r\n7.54\r\n4.60 × 10−9BMI\r\n111.76\r\n11.94\r\n9.36\r\n2.06 × 10−11SMOKER\r\n454.08\r\n125.83\r\n3.61\r\n8.84 × 10−4CHARITY\r\n−0.55\r\n0.18\r\n−3.06\r\n4.06 × 10−3Residual standard error: 295.2 on 38 degrees of freedom\r\n    Multiple R-squared:  0.8343,    Adjusted R-squared:  0.8168\r\n    F-statistic: 47.82 on 4 and 38 DF,  p-value: 2.486e-14\r\n    \r\n\r\nmean(results1$y) # cost\r\n\r\n\r\n[1] 4150.588\r\n\r\nmean(results1$x0) # intercept\r\n\r\n\r\n[1] 145.2152\r\n\r\nmean(results1$x1) # age\r\n\r\n\r\n[1] 38.51163\r\n\r\nmean(results1$x2) # bmi\r\n\r\n\r\n[1] 22.16166\r\n\r\nmean(results1$x3) # smoker\r\n\r\n\r\n[1] 0.1627907\r\n\r\nmean(results1$x4) # charity\r\n\r\n\r\n[1] 490.6912\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-17-bt-question-set-p1-t2-20-18-multivariate-regressions/P1-T2-20-18-3b.png",
    "last_modified": "2022-01-30T18:00:11-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-17-p1-t2-20-17-univariate-regressions-continued-2nd-set-v2/",
    "title": "BT PQ P1-T2-20-17. Univariate regressions cont (2nd set v2)",
    "description": "Coefficient confidence interval (CI); hypothesis test; interpretation of SE, t-stat and p-value",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-07",
    "categories": [],
    "contents": "\r\nLearning objectives\r\nConstruct, apply, and interpret hypothesis tests and confidence intervals for a single regression coefficient in a regression.\r\nExplain the steps needed to perform a hypothesis test in a linear regression.\r\nDescribe the relationship between a t-statistic, its p-value, and a confidence interval.\r\nLet’s load some packages!\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(tidyquant)\r\nlibrary(lubridate)\r\nlibrary(readxl)\r\nlibrary(timetk)\r\nlibrary(tibbletime)\r\nlibrary(quantmod)\r\nlibrary(PerformanceAnalytics)\r\nlibrary(scales)\r\nlibrary(broom)\r\nlibrary(gt)\r\n\r\n\r\n\r\nFirst question\r\nBT 20.17.1. Below the results of a linear regression analysis are displayed. The dataset is monthly returns over a six-year period; i.e., n = 72 months. The gross returns of Apple’s stock (ticker: AAPL) were regressed against the S&P 1500 Index (the S&P 1500 is our proxy for the market). The explanatory variable is SP_1500 and the response (aka, dependent) variable is AAPL.\r\nQuestion: Which is nearest to the 90.0% confidence interval for the beta of Apple’s (AAPL) stock?\r\n\r\n\r\nAAPL <- tq_get('AAPL',\r\n               from = \"2009-01-01\",\r\n               to = \"2020-01-01\")\r\n\r\nSP1500 <- tq_get('SPTM',\r\n               from = \"2009-01-01\",\r\n               to = \"2020-01-01\")\r\n\r\nAAPL <- AAPL %>% select(date, adjusted)\r\nSP1500 <- SP1500 %>% select(date, adjusted)\r\n\r\nAAPL_monthly <- AAPL %>% \r\n  tq_transmute(select = adjusted, mutate = to.monthly, indexAt = \"lastof\")\r\nSP1500_monthly <- SP1500 %>% \r\n  tq_transmute(select = adjusted, mutate = to.monthly, indexAt = \"lastof\")\r\n\r\nAAPL_monthly <- AAPL_monthly %>% mutate(\r\n  r_m_AAPL = log(adjusted/lag(adjusted)))\r\nSP1500_monthly <-SP1500_monthly %>% mutate(\r\n  r_m_SP = log(adjusted/lag(adjusted)))\r\n\r\nAAPL_monthly <- AAPL_monthly %>% \r\n  rename(date_AAPL = date,\r\n         adj_AAPL = adjusted)\r\nSP1500_monthly <- SP1500_monthly %>% \r\n  rename(date_SP = date,\r\n         adj_SP = adjusted)\r\n\r\nboth_monthly <- cbind(SP1500_monthly, AAPL_monthly)\r\n\r\nboth_72 <- both_monthly[-c(1:60), ]\r\nboth_72 <- both_72 %>% rename(r_SP_1500 = r_m_SP)\r\nsaveRDS(both_72, \"t2-20-17-aapl-sp1500.rds\")\r\n\r\ncon <- url(\"http://frm-bionicturtle.s3.amazonaws.com/david/t2-20-17-aapl-sp1500.rds\")\r\nboth_72 <- readRDS(con)\r\nclose(con)\r\n\r\n\r\nmodel_72 <- lm(r_m_AAPL ~ r_SP_1500, data = both_72)\r\nsummary(model_72)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = r_m_AAPL ~ r_SP_1500, data = both_72)\r\n\r\nResiduals:\r\n      Min        1Q    Median        3Q       Max \r\n-0.226290 -0.027060  0.002344  0.040667  0.131313 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) 0.007969   0.007477   1.066     0.29    \r\nr_SP_1500   1.269627   0.215600   5.889 1.23e-07 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.06123 on 70 degrees of freedom\r\nMultiple R-squared:  0.3313,    Adjusted R-squared:  0.3217 \r\nF-statistic: 34.68 on 1 and 70 DF,  p-value: 1.23e-07\r\n\r\np1_model_72 <- both_72 %>% ggplot(aes(r_SP_1500, r_m_AAPL)) +\r\n  geom_point() +\r\n  geom_smooth(method = \"lm\")\r\n\r\nmodel_72_tidy <- tidy(model_72)\r\n\r\ngt_table_model_72 <- gt(model_72_tidy)\r\n\r\ngt_table_model_72 <- \r\n  gt_table_model_72 %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"AAPL versus S&P_1500: Gross (incl. Rf) monthly log return\",\r\n    subtitle = md(\"Six years (2014 - 2019), n = 72 months\")\r\n  ) %>% \r\n  tab_source_note(\r\n    source_note = \"Source: tidyquant https://cran.r-project.org/web/packages/tidyquant/\"\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic),\r\n    decimals = 3\r\n  ) %>% fmt_scientific(\r\n    columns = vars(p.value),\r\n  ) %>% \r\n  tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12\r\n  )\r\n\r\ngt_table_model_72\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#zsnmnutuwo .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#zsnmnutuwo .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#zsnmnutuwo .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#zsnmnutuwo .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#zsnmnutuwo .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#zsnmnutuwo .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#zsnmnutuwo .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#zsnmnutuwo .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#zsnmnutuwo .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#zsnmnutuwo .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#zsnmnutuwo .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#zsnmnutuwo .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#zsnmnutuwo .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#zsnmnutuwo .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#zsnmnutuwo .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#zsnmnutuwo .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#zsnmnutuwo .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#zsnmnutuwo .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#zsnmnutuwo .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#zsnmnutuwo .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#zsnmnutuwo .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#zsnmnutuwo .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#zsnmnutuwo .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#zsnmnutuwo .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#zsnmnutuwo .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#zsnmnutuwo .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#zsnmnutuwo .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#zsnmnutuwo .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#zsnmnutuwo .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#zsnmnutuwo .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#zsnmnutuwo .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#zsnmnutuwo .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#zsnmnutuwo .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#zsnmnutuwo .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#zsnmnutuwo .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nAAPL versus S&P_1500: Gross (incl. Rf) monthly log return\r\n    Six years (2014 - 2019), n = 72 months\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n0.008\r\n0.007\r\n1.066\r\n2.90 × 10−1r_SP_1500\r\n1.270\r\n0.216\r\n5.889\r\n1.23 × 10−7Source: tidyquant https://cran.r-project.org/web/packages/tidyquant/\r\n    \r\n\r\np1_model_72\r\n\r\n\r\n\r\nsummary(model_72)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = r_m_AAPL ~ r_SP_1500, data = both_72)\r\n\r\nResiduals:\r\n      Min        1Q    Median        3Q       Max \r\n-0.226290 -0.027060  0.002344  0.040667  0.131313 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) 0.007969   0.007477   1.066     0.29    \r\nr_SP_1500   1.269627   0.215600   5.889 1.23e-07 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.06123 on 70 degrees of freedom\r\nMultiple R-squared:  0.3313,    Adjusted R-squared:  0.3217 \r\nF-statistic: 34.68 on 1 and 70 DF,  p-value: 1.23e-07\r\n\r\nbeta <- model_72_tidy$estimate[2]\r\nse_beta <- model_72_tidy$std.error[2]\r\nci_confidence = 0.90\r\nz_2s <- qnorm((1 + ci_confidence)/2)\r\nci_lower <- beta - se_beta*z_2s\r\nci_upper <- beta + se_beta*z_2s\r\n\r\nci_lower\r\n\r\n\r\n[1] 0.9149958\r\n\r\nci_upper\r\n\r\n\r\n[1] 1.624257\r\n\r\nSecond question\r\nBT 20.17.2. Peter wants to add a low-beta stock to his portfolio. One candidate is Kroger’s stock (ticker: KR). As a proxy for the market, he uses the S&P 1500. He wrangled gross monthly returns for KR and SP_1500 over ten years such that his sample size is 120 pairwise returns. The regression results are displayed below.\r\nPeters wants to make two decisions. In both cases, his test is a two-sided hypothesis test with 99.0% confidence. In the first test, the null hypothesis is that KR’s beta is zero. In the second test, the null hypothesis is that KR’s beta is one (1.0). Based on these regression results, which of the following is TRUE as a valid inference?\r\n\r\n\r\nKR <- tq_get('KR',\r\n               from = \"2009-01-01\",\r\n               to = \"2020-01-01\")\r\n\r\nSP1500 <- tq_get('SPTM',\r\n               from = \"2009-01-01\",\r\n               to = \"2020-01-01\")\r\n\r\nKR <- KR %>% select(date, adjusted)\r\nSP1500 <- SP1500 %>% select(date, adjusted)\r\n\r\nKR_monthly <- KR %>% \r\n  tq_transmute(select = adjusted, mutate = to.monthly, indexAt = \"lastof\")\r\nSP1500_monthly <- SP1500 %>% \r\n  tq_transmute(select = adjusted, mutate = to.monthly, indexAt = \"lastof\")\r\n\r\nKR_monthly <- KR_monthly %>% mutate(\r\n  r_m_KR = log(adjusted/lag(adjusted)))\r\n\r\nSP1500_monthly <-SP1500_monthly %>% mutate(\r\n  r_m_SP = log(adjusted/lag(adjusted)))\r\n\r\nKR_monthly <- KR_monthly %>% \r\n  rename(date_KR = date,\r\n         adj_KR = adjusted)\r\n\r\nSP1500_monthly <- SP1500_monthly %>% \r\n  rename(date_SP = date,\r\n         adj_SP = adjusted)\r\n\r\nboth_monthly <- cbind(SP1500_monthly, KR_monthly)\r\n\r\n# testing different relationships really for Q&A properties\r\n# both_131 <- both_monthly[-1, ]\r\nboth_120 <- both_monthly[-c(1:12), ]\r\n# both_108 <- both_monthly[-c(1:24), ]\r\n# both_96 <- both_monthly[-c(1:36), ]\r\n# both_84 <- both_monthly[-c(1:48), ]\r\n# both_72 <- both_monthly[-c(1:60), ]\r\n\r\nboth_120 <- both_120 %>% rename(SP_1500 = r_m_SP)\r\nsaveRDS(both_120, \"t2-20-17-kroger-sp1500.rds\")\r\n\r\ncon <- url(\"http://frm-bionicturtle.s3.amazonaws.com/david/t2-20-17-kroger-sp1500.rds\")\r\nboth_120 <- readRDS(con)\r\nclose(con)\r\n\r\nboth_120 %>% ggplot(aes(x = SP_1500, y = r_m_KR)) +\r\n  geom_point() +\r\n  geom_smooth(method = \"lm\", se = FALSE)\r\n\r\n\r\n\r\nmodel_120 <- lm(r_m_KR ~ SP_1500, data = both_120)\r\nsummary(model_120)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = r_m_KR ~ SP_1500, data = both_120)\r\n\r\nResiduals:\r\n      Min        1Q    Median        3Q       Max \r\n-0.255113 -0.039050  0.009397  0.043573  0.203206 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) 0.003594   0.006433   0.559    0.577    \r\nSP_1500     0.696484   0.169073   4.119 7.08e-05 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.06775 on 118 degrees of freedom\r\nMultiple R-squared:  0.1257,    Adjusted R-squared:  0.1183 \r\nF-statistic: 16.97 on 1 and 118 DF,  p-value: 7.082e-05\r\n\r\n###\r\n\r\nmodel_120_tidy <- tidy(model_120)\r\n\r\ngt_table_model_120 <- gt(model_120_tidy)\r\n\r\ngt_table_model_120 <- \r\n  gt_table_model_120 %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"Kroger (KR) versus S&P_1500: Gross (incl. Rf) monthly log return\",\r\n    subtitle = md(\"Ten years (2010 - 2019), n = 120 months\")\r\n  ) %>% \r\n  tab_source_note(\r\n    source_note = \"Source: tidyquant https://cran.r-project.org/web/packages/tidyquant/\"\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic),\r\n    decimals = 4\r\n  ) %>% fmt_scientific(\r\n    columns = vars(p.value),\r\n  ) %>% \r\n  tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12\r\n  )\r\n\r\ngt_table_model_120\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#cvjsrcnnpv .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#cvjsrcnnpv .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#cvjsrcnnpv .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#cvjsrcnnpv .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#cvjsrcnnpv .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#cvjsrcnnpv .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#cvjsrcnnpv .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#cvjsrcnnpv .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#cvjsrcnnpv .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#cvjsrcnnpv .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#cvjsrcnnpv .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#cvjsrcnnpv .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#cvjsrcnnpv .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#cvjsrcnnpv .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#cvjsrcnnpv .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#cvjsrcnnpv .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#cvjsrcnnpv .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#cvjsrcnnpv .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#cvjsrcnnpv .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#cvjsrcnnpv .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#cvjsrcnnpv .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#cvjsrcnnpv .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#cvjsrcnnpv .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#cvjsrcnnpv .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#cvjsrcnnpv .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#cvjsrcnnpv .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#cvjsrcnnpv .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#cvjsrcnnpv .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#cvjsrcnnpv .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#cvjsrcnnpv .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#cvjsrcnnpv .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#cvjsrcnnpv .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#cvjsrcnnpv .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#cvjsrcnnpv .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#cvjsrcnnpv .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nKroger (KR) versus S&P_1500: Gross (incl. Rf) monthly log return\r\n    Ten years (2010 - 2019), n = 120 months\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n0.0036\r\n0.0064\r\n0.5587\r\n5.77 × 10−1SP_1500\r\n0.6965\r\n0.1691\r\n4.1194\r\n7.08 × 10−5Source: tidyquant https://cran.r-project.org/web/packages/tidyquant/\r\n    \r\n\r\nThird question\r\nBT 20.17.3. Debra is an economist who is interested in the relationship between consumer spending and the gross domestic product (GDP). From the FRED database at the Fed’s Bank of St. Louis (https://fred.stlouisfed.org/) she collects quarterly data from 1980 through the first quarter of 2020; her series includes n = 161 quarters of data. She regresses consumer spending (C_SPEND), as the response (aka, dependent) variable against GDP as the explanatory (aka, independent) variable. Each series is not a level, but rather a seasonally adjusted percent change. The regression results are displayed below.\r\n\r\n\r\nlibrary(alfred)\r\nlibrary(ggplot2)\r\n\r\n\r\n# startdate <- \"1980-01-01\"\r\n# enddate <- \"2020-01-01\"\r\n# startdate1 <- \"1980-01-01\"\r\n# enddate1 <- \"2020-01-01\"\r\n\r\n# gdp <- get_fred_series(\"A191RP1Q027SBEA\", \"GDP\", observation_start = startdate1, observation_end = enddate1)\r\n# cspend <- get_fred_series(\"DPCERL1Q225SBEA\", \"C_Spend\", observation_start = startdate1, observation_end = enddate1)\r\n# testing\r\n# cdebt <- get_fred_series(\"CDSP\", \"C_Debt\", observation_start = startdate1, observation_end = enddate1)\r\n# df1 <- cbind(gdp, cdebt)\r\n# df1 <- df1[-3]\r\n\r\n# df2 <- cbind(gdp, cspend)\r\n# df2 <- df2[-3]\r\n# df2 <- df2 %>% rename(C_SPEND = C_Spend)\r\n# saving dataframe because series data changed in the meantime!\r\n# saveRDS(df2, \"t2-20-17-spend-versus-gdp.rds\")\r\n\r\ncon <- url(\"http://frm-bionicturtle.s3.amazonaws.com/david/t2-20-17-spend-versus-gdp.rds\")\r\ndf2 <- readRDS(con)\r\nclose(con)\r\n\r\nggplot(df2, aes(GDP, C_SPEND)) + \r\n  geom_point() + \r\n  geom_smooth(method = \"lm\")\r\n\r\n\r\n\r\nmodel_spend <- lm(C_SPEND ~ GDP, data = df2)\r\nsummary(model_spend)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = C_SPEND ~ GDP, data = df2)\r\n\r\nResiduals:\r\n     Min       1Q   Median       3Q      Max \r\n-10.0025  -1.1513   0.2266   1.2048   4.6900 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  0.89995    0.31555   2.852  0.00492 ** \r\nGDP          0.36591    0.04993   7.329 1.11e-11 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 2.155 on 159 degrees of freedom\r\nMultiple R-squared:  0.2525,    Adjusted R-squared:  0.2478 \r\nF-statistic: 53.71 on 1 and 159 DF,  p-value: 1.107e-11\r\n\r\ndf_fit_tidy <- tidy(model_spend)\r\n\r\nsd(df2$GDP)\r\n\r\n\r\n[1] 3.411722\r\n\r\nsd(df2$C_SPEND)\r\n\r\n\r\n[1] 2.484429\r\n\r\ncor(df2$GDP, df2$C_SPEND)\r\n\r\n\r\n[1] 0.5024882\r\n\r\nbeta <- df_fit_tidy$estimate[2]\r\nbeta_r <- round(beta,4)\r\nsd_gdp <- round(sd(df2$GDP),3)\r\nsd_spend <- round(sd(df2$C_SPEND),3)\r\ncorrelation_compute <- beta_r * sd_gdp/sd_spend\r\n\r\ngt_table <- gt(df_fit_tidy)\r\n\r\ngt_table <- \r\n  gt_table %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"Consumer Spending (C_SPEND) regressed against Gross Domestic Product (GDP)\",\r\n    subtitle = md(\"Quarterly Growth (Seasonally adjusted), 1980 to 2020:Q1, n = 161\")\r\n  ) %>% \r\n  tab_source_note(\r\n    source_note = md(\"Source: FRED at https://fred.stlouisfed.org/\")\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic),\r\n    decimals = 4\r\n  ) %>% fmt_scientific(\r\n    columns = vars(p.value),\r\n  ) %>% \r\n  tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12\r\n  )\r\n\r\ngt_table\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#bgdoadunag .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#bgdoadunag .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#bgdoadunag .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#bgdoadunag .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#bgdoadunag .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#bgdoadunag .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#bgdoadunag .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#bgdoadunag .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#bgdoadunag .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#bgdoadunag .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#bgdoadunag .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#bgdoadunag .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#bgdoadunag .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#bgdoadunag .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#bgdoadunag .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#bgdoadunag .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#bgdoadunag .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#bgdoadunag .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#bgdoadunag .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#bgdoadunag .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#bgdoadunag .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#bgdoadunag .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#bgdoadunag .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#bgdoadunag .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#bgdoadunag .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#bgdoadunag .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#bgdoadunag .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#bgdoadunag .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#bgdoadunag .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#bgdoadunag .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#bgdoadunag .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#bgdoadunag .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#bgdoadunag .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#bgdoadunag .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#bgdoadunag .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nConsumer Spending (C_SPEND) regressed against Gross Domestic Product (GDP)\r\n    Quarterly Growth (Seasonally adjusted), 1980 to 2020:Q1, n = 161\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n0.9000\r\n0.3156\r\n2.8520\r\n4.92 × 10−3GDP\r\n0.3659\r\n0.0499\r\n7.3285\r\n1.11 × 10−11Source: FRED at https://fred.stlouisfed.org/\r\n    \r\n\r\ndf_fit_tidy$p.value[2]\r\n\r\n\r\n[1] 1.106954e-11\r\n\r\ny_intercept <- df_fit_tidy$estimate[1]\r\nse_y_intercept <- df_fit_tidy$std.error[1]\r\nci_confidence = 0.95\r\nz_2s <- qnorm((1 + ci_confidence)/2)\r\n\r\nci_lower <- y_intercept - se_y_intercept*z_2s\r\nci_upper <- y_intercept + se_y_intercept*z_2s\r\nci_lower\r\n\r\n\r\n[1] 0.2814779\r\n\r\nci_upper\r\n\r\n\r\n[1] 1.518425\r\n\r\nslope_c <-df_fit_tidy$estimate[2]\r\nse_slope <- df_fit_tidy$std.error[2]\r\nslope_ci_lower <- slope_c - se_slope * z_2s\r\nslope_ci_upper <- slope_c + se_slope * z_2s\r\nslope_ci_lower\r\n\r\n\r\n[1] 0.2680529\r\n\r\nslope_ci_upper\r\n\r\n\r\n[1] 0.463775\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-17-p1-t2-20-17-univariate-regressions-continued-2nd-set-v2/p1-t2-20-17-univariate-regressions-continued-2nd-set-v2_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-01-30T18:04:04-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-16-bt-question-p1-t2-20-16-3-univariate-regression-monthly-rental-versus-footage/",
    "title": "BT PQ P1-T2-20-16-3: Univariate regression: Monthly rental versus footage",
    "description": "Monthly rent against feet^2 per kaggle dataset",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-06",
    "categories": [],
    "contents": "\r\n20.16.3. Sally works at a real estate firm and was asked by her client to quantify the relationship between rental size (in square feet) and rental price. She explained to her client that the relationship is multivariate but, given that caveat, she offered to perform a linear regression with a single explanatory variable. She retrieved a massive dataset (n = 360,400 observations and includes rentals across the United States) and regressed monthly rental price (aka, the explained variable) against rental size as measured by square feet. To illustrate the units, one of data points in the dataset is (y = $1,200 per month, X = 1,000 feet^2). The results are displayed below.\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(gt)\r\nlibrary(broom)\r\n\r\n# rentals_raw <- read_csv(\"housing.csv\")\r\n# rentals_sort <- rentals %>% arrange(price)\r\n# rentals_df1 <- rentals_raw %>% filter(price > 500, price < 10000, \r\n#                                       sqfeet> 500, sqfeet < 10000)\r\n# boxplot(rentals$price)\r\n# boxplot(rentals$price)$out\r\n# \r\n# rentals_df1 <- rentals_df1 %>% rename(\r\n#  \"Price\" = \"price\",\r\n#  \"SquareFeet\" = \"sqfeet\")\r\n# \r\n# saveRDS(rentals_df1, \"rentals-sm.rds\")\r\n\r\ncon <- url(\"http://frm-bionicturtle.s3.amazonaws.com/david/rentals-sm.rds\")\r\nrentals_df1 <- readRDS(con)\r\nclose(con)\r\n\r\nmodel1 <- rentals_df1 %>% lm(Price ~ SquareFeet, data =  .)\r\nsummary(model1)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = Price ~ SquareFeet, data = .)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-5382.8  -325.1  -122.7   185.9  8262.4 \r\n\r\nCoefficients:\r\n             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept) 624.42303    2.59775   240.4   <2e-16 ***\r\nSquareFeet    0.57889    0.00239   242.2   <2e-16 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 545.4 on 360399 degrees of freedom\r\nMultiple R-squared:   0.14, Adjusted R-squared:   0.14 \r\nF-statistic: 5.866e+04 on 1 and 360399 DF,  p-value: < 2.2e-16\r\n\r\nprice_avg_act <- mean(rentals_df1$Price)\r\nsize_ave_act <- mean(rentals_df1$SquareFeet)\r\n\r\nnew.df.rentals <- data.frame(SquareFeet = c(1000, 1500, 1800, 2000, 2500))\r\npredict(model1, new.df.rentals)\r\n\r\n\r\n       1        2        3        4        5 \r\n1203.313 1492.758 1666.425 1782.203 2071.648 \r\n\r\nmodel1_tidy <- tidy(model1)\r\n\r\ngt_table_rentals <- gt(model1_tidy)\r\n\r\ngt_table_rentals <- \r\n  gt_table_rentals %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"Monthly Rental PRICE regressed against Square Feet\",\r\n    subtitle = md(\"Entire United States, n = 360,400 observations\")\r\n  ) %>% \r\n  tab_source_note(\r\n    source_note = \"Source: USA Housing Listings @ kaggle https://www.kaggle.com/datasets\"\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic),\r\n    decimals = 3\r\n  ) %>% fmt_scientific(\r\n    columns = vars(p.value),\r\n  ) %>% \r\n  tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12\r\n  )\r\n  \r\ngt_table_rentals\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#yrevzvqpuq .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#yrevzvqpuq .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#yrevzvqpuq .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#yrevzvqpuq .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 4px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#yrevzvqpuq .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#yrevzvqpuq .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#yrevzvqpuq .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#yrevzvqpuq .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#yrevzvqpuq .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#yrevzvqpuq .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#yrevzvqpuq .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#yrevzvqpuq .gt_group_heading {\r\n  padding: 8px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#yrevzvqpuq .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#yrevzvqpuq .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#yrevzvqpuq .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#yrevzvqpuq .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#yrevzvqpuq .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 12px;\r\n}\r\n\r\n#yrevzvqpuq .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#yrevzvqpuq .gt_first_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#yrevzvqpuq .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#yrevzvqpuq .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#yrevzvqpuq .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#yrevzvqpuq .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#yrevzvqpuq .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#yrevzvqpuq .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#yrevzvqpuq .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#yrevzvqpuq .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding: 4px;\r\n}\r\n\r\n#yrevzvqpuq .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#yrevzvqpuq .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#yrevzvqpuq .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#yrevzvqpuq .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#yrevzvqpuq .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#yrevzvqpuq .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#yrevzvqpuq .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#yrevzvqpuq .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 65%;\r\n}\r\nMonthly Rental PRICE regressed against Square Feet\r\n    Entire United States, n = 360,400 observations\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n624.423\r\n2.598\r\n240.370\r\n0.00SquareFeet\r\n0.579\r\n0.002\r\n242.206\r\n0.00Source: USA Housing Listings @ kaggle https://www.kaggle.com/datasets\r\n    \r\n\r\nrentals_df1 %>% ggplot(aes(SquareFeet, Price)) +\r\n  geom_point() +\r\n  geom_smooth(method = \"lm\")\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-16-bt-question-p1-t2-20-16-3-univariate-regression-monthly-rental-versus-footage/bt-question-p1-t2-20-16-3-univariate-regression-monthly-rental-versus-footage_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-01-30T18:01:40-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-16-bt-question-p1-t2-20-16-2-univariate-regression-portfolio-versus-benchmark-returns/",
    "title": "BT PQ P1-T2-20-16-2: Univariate regression: Portfolio versus benchmark returns",
    "description": "Simulated portfolio & benchmark for purposes of testing basic features of univariate regression",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-05",
    "categories": [],
    "contents": "\r\n20.16.2. Peter is an analyst who is evaluating an investment fund whose managers claim has outperformed their benchmark. He collected monthly returns for the last five years; i.e., the sample size is excess return pairs over n = 60 months. He plots excess returns, which are defined as the returns in excess of the riskfree rate; ie., an excess return equals the gross return minus the riskfree rate. The scatterplot is displayed below:\r\nscatterplot\r\nThe correlation coefficient is 0.708. In regard to the univariate data, the standard deviation of the portfolio’s returns is 22.84% and the standard deviation of the benchmark’s returns is 9.79%. The average excess return of the benchmark was -0.37% and the average excess return of the portfolio was 2.61%. Each of the following statements is true EXCEPT which is false?\r\nThe slope of the regression line is approximately 1.65 and the intercept is approximately 3.22%\r\nVisual inspection confirms the error variance is not constant and we can, therefore, assert the presence of heteroskedastic shocks\r\nThis regression line passes through the coordinates of averages, (μ_x, μ_y) = (-0.37%, +2.61%), although this is not an actual pairwise observation\r\nThis model appears to at least meet the three essential restrictions of a linear regression model including linearity in the coefficients (aka, parameters)\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(scales)\r\nlibrary(ggthemes)\r\n# library(lmtest)\r\n\r\nx_mu <- .01; x_sig <- .1\r\n\r\ny_mu <- .03; y_sig <- .2\r\n\r\nrho <-  0.72\r\nmonths <- 60\r\n\r\n#set.seed(59)\r\nset.seed(158)\r\n\r\n# 60  rows of random standard normals\r\nreturns <- tibble(index = 1:months)\r\nreturns$x1 <- rnorm(months) \r\nreturns$y1 <- rnorm(months)\r\n\r\n# make y2 correlated with y1; adjust location/scale\r\nreturns1 <- returns %>% mutate(\r\n  y2 = rho*x1 + sqrt(1 - rho^2)*y1,\r\n  r_x = x_mu + x1 * x_sig,\r\n  r_y = y_mu + y2 * y_sig\r\n)\r\n\r\nx_sd <- sd(returns1$r_x)\r\ny_sd <- sd(returns1$r_y)\r\nrho_xy <- cor(returns1$r_x, returns1$r_y)\r\nbeta_yx <- rho_xy * y_sd / x_sd\r\nx_mu_act <- mean(returns1$r_x)\r\ny_mu_act <- mean(returns1$r_y)\r\n\r\nsprintf(\"sample rho is %.4f. The standard deviation of Portfolio returns is \", rho_xy)\r\n\r\n\r\n[1] \"sample rho is 0.7078. The standard deviation of Portfolio returns is \"\r\n\r\npaste(\"Portfolio standard deviation is\", percent(y_sd, accuracy = .01))\r\n\r\n\r\n[1] \"Portfolio standard deviation is 22.84%\"\r\n\r\npaste(\"Benchmark standard deviation is\", percent(x_sd, accuracy = .01))\r\n\r\n\r\n[1] \"Benchmark standard deviation is 9.79%\"\r\n\r\npaste(\"Portfolio average excess return is\", percent(y_mu_act, accuracy = .01))\r\n\r\n\r\n[1] \"Portfolio average excess return is 2.61%\"\r\n\r\npaste(\"Benchmark average excess return is\", percent(x_mu_act, accuracy = .01))\r\n\r\n\r\n[1] \"Benchmark average excess return is -0.37%\"\r\n\r\nsprintf(\"Beta(P,B) is %.3f\", beta_yx) \r\n\r\n\r\n[1] \"Beta(P,B) is 1.652\"\r\n\r\nreturns1_lm <- lm(r_y ~ r_x, data = returns1)\r\nsummary(returns1_lm)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = r_y ~ r_x, data = returns1)\r\n\r\nResiduals:\r\n     Min       1Q   Median       3Q      Max \r\n-0.30810 -0.11231 -0.01385  0.09922  0.42134 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  0.03231    0.02102   1.537     0.13    \r\nr_x          1.65219    0.21649   7.632 2.54e-10 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.1627 on 58 degrees of freedom\r\nMultiple R-squared:  0.501, Adjusted R-squared:  0.4924 \r\nF-statistic: 58.24 on 1 and 58 DF,  p-value: 2.543e-10\r\n\r\nreturns1 %>% ggplot(aes(x = r_x, y = r_y)) +\r\n  geom_point() +\r\n  geom_smooth(method = \"lm\", se = FALSE, color = \"forestgreen\", linetype = \"longdash\", size = 1.5) +\r\n  ggtitle(\"Investment fund versus benchmark: Excess returns, n = 60 months\") +\r\n  xlab(\"Benchmark's excess returns\") +\r\n  ylab(\"Portfolio's excess returns\") +\r\n  scale_x_continuous(labels = percent_format(accuracy = 1)) +\r\n  scale_y_continuous(labels = percent_format(accuracy = 1)) +\r\n  theme_light() +\r\n  theme(\r\n    axis.title.y = element_text(size = 14),\r\n    axis.title.x = element_text(size = 14),\r\n    axis.text.x = element_text(size = 14, margin = margin(b = 10)),\r\n    axis.text.y = element_text(size = 14, margin = margin(l = 10))\r\n  )\r\n\r\n\r\n\r\nplot(returns1_lm)\r\n\r\n\r\n\r\nnew.df <- data.frame(r_x = c(x_mu_act, 0, seq(from = 0.01, to = 0.1, by = .01)))\r\nnew.df$predicted_y <- predict(returns1_lm, new.df)\r\nnew.df\r\n\r\n\r\n            r_x predicted_y\r\n1  -0.003740684  0.02613168\r\n2   0.000000000  0.03231199\r\n3   0.010000000  0.04883388\r\n4   0.020000000  0.06535577\r\n5   0.030000000  0.08187766\r\n6   0.040000000  0.09839955\r\n7   0.050000000  0.11492143\r\n8   0.060000000  0.13144332\r\n9   0.070000000  0.14796521\r\n10  0.080000000  0.16448710\r\n11  0.090000000  0.18100899\r\n12  0.100000000  0.19753088\r\n\r\nintercept_predict <- (0 - x_mu_act)*beta_yx + y_mu_act\r\nintercept_predict_round <- (0 - round(x_mu_act,4))*beta_yx + round(y_mu_act,4)\r\nintercept_predict\r\n\r\n\r\n[1] 0.03231199\r\n\r\nintercept_predict_round\r\n\r\n\r\n[1] 0.0322131\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-16-bt-question-p1-t2-20-16-2-univariate-regression-portfolio-versus-benchmark-returns/bt-question-p1-t2-20-16-2-univariate-regression-portfolio-versus-benchmark-returns_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-01-30T18:02:49-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-16-bt-pq-p1-t2-20-16-1-univariate-regression-inflation-versus-unemployment/",
    "title": "BT PQ P1-T2-20-16-1: Univariate regression: Inflation versus unemployment",
    "description": "With FRED data and applying gt_table",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-04",
    "categories": [],
    "contents": "\r\nBackground\r\nBT is known for our tough training-style practice questions, and we\r\nlove it, but I wanted to take it further and add more realism. I’ve been\r\nwriting a fresh question sets on the regression topics; I’m always\r\nwriting new questions! It takes more time, but in these regression sets\r\nI’ve been pulling actual datasets. For this question, I pulled inflation\r\nand unemployment rates from the FRED database (see below). In\r\ncombination with actual code-based applications, these new\r\nquestion sets are much more realistic than typical\r\nexam-prep fare. Let’s face it: in the real world, quantitative tasks\r\n(e.g., regression) are performed in software, not with calculators. In a\r\nway, it’s our responsibility to help candidates get exposure to tools\r\nthat are actually useful. We’ve always been the only FRM exam prep\r\nprovider (EPP) who develops virtually the entire, broad array of\r\nquantitative risk (FRM) topics in spreadsheet workbooks (this is a\r\nmassive construction of hundreds of spreadsheets that has taken me the\r\nbetter part of a decade to build). Now I’ve started to develop\r\nassociated code-based applications for the ultimate in\r\nrealistic study material.\r\nUsing\r\nthe gt package to render the regression output table\r\nI thought I’d try the gt\r\npackage to see if I could improve the presentation of the regression\r\noutput table. It’s fairly intuitive but a little unexpected because you\r\npipe (“%>%”) additional format features.\r\nThis question (my first in the new regression set) reads as\r\nfollows:\r\n\r\n“20.16.1. Debra is an analyst at a governmental agency. Her boss\r\nasked her to investigate whether the Phillips curve applies during\r\nhigh-inflation regimes. To answer the question, Debra collected data\r\nfrom the FRED database at the St. Louis Fed (https://fred.stlouisfed.org/). The Phillips curve\r\ndescribes an inverse relationship between unemployment rates and\r\ninflation rates; https://en.wikipedia.org/wiki/Phillips_curve. Debra\r\ncollected monthly data and she regressed the inflation rate against the\r\nunemployment rate (conditional on high-inflation regimes). Her\r\nindependent variable is unemployment rate (FRED code: UNRATE) and here\r\ndependent variable is the Inflation rate (CPIAUCSL). The units are\r\npercentages not decimals; e.g., the dataset includes the month of\r\nJanuary in 1982 when the unemployment rate was 8.9 and the inflation\r\nrate was 6.38. Her regression results are presented below.”\r\n\r\nWe load the packages\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(gt) # library(reactable) is another table package I haven't used\r\nlibrary(alfred) # Direct access to FRED\r\nlibrary(broom)\r\n\r\n\r\n\r\nAnd then see if we might find a super-simple (ie, linear) Phillips\r\ncurve (BT Question P1.T2.20.16.1)\r\n\r\n\r\nstartdate <- \"1980-01-01\"\r\nenddate <- \"2020-01-01\"\r\n\r\n# Phillips x = unemployment\r\nunrate <- get_fred_series(\"UNRATE\", \"Unemployment\", observation_start = startdate, observation_end = enddate)\r\ninflation <- get_fred_series(\"CPIAUCSL\", \"inflation\", observation_start = startdate, observation_end = enddate)\r\ninflation_rate <- get_fred_series(\"PCETRIM12M159SFRBDAL\", \"Inflation_Rate\", observation_start = startdate, observation_end = enddate)\r\ndf1 <- cbind(inflation, unrate, inflation_rate)\r\ndf1 <- df1[ , c(1,2, 4, 6)]\r\ndf2 <- df1 %>% filter(Inflation_Rate > 4.3)\r\ndf_fit <- lm(Inflation_Rate ~ Unemployment, data = df2)\r\nsummary(df_fit)\r\n\r\n\r\n\r\nCall:\r\nlm(formula = Inflation_Rate ~ Unemployment, data = df2)\r\n\r\nResiduals:\r\n     Min       1Q   Median       3Q      Max \r\n-1.27424 -0.22839 -0.03048  0.25065  0.83494 \r\n\r\nCoefficients:\r\n             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  16.39276    0.47342   34.63   <2e-16 ***\r\nUnemployment -1.10612    0.05577  -19.83   <2e-16 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.473 on 38 degrees of freedom\r\nMultiple R-squared:  0.9119,    Adjusted R-squared:  0.9096 \r\nF-statistic: 393.4 on 1 and 38 DF,  p-value: < 2.2e-16\r\n\r\ndf_fit_tidy <- tidy(df_fit)\r\ngt_table <- gt(df_fit_tidy)\r\n\r\n# This is the standard gt table which is an improvement\r\ngt_table\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#rjmncmzeju .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#rjmncmzeju .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#rjmncmzeju .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#rjmncmzeju .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#rjmncmzeju .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#rjmncmzeju .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#rjmncmzeju .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#rjmncmzeju .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#rjmncmzeju .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#rjmncmzeju .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#rjmncmzeju .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 5px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#rjmncmzeju .gt_group_heading {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#rjmncmzeju .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#rjmncmzeju .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#rjmncmzeju .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#rjmncmzeju .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#rjmncmzeju .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#rjmncmzeju .gt_stub_row_group {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  vertical-align: top;\r\n}\r\n\r\n#rjmncmzeju .gt_row_group_first td {\r\n  border-top-width: 2px;\r\n}\r\n\r\n#rjmncmzeju .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#rjmncmzeju .gt_first_summary_row {\r\n  border-top-style: solid;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#rjmncmzeju .gt_first_summary_row.thick {\r\n  border-top-width: 2px;\r\n}\r\n\r\n#rjmncmzeju .gt_last_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#rjmncmzeju .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#rjmncmzeju .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#rjmncmzeju .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#rjmncmzeju .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#rjmncmzeju .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#rjmncmzeju .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#rjmncmzeju .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#rjmncmzeju .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#rjmncmzeju .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#rjmncmzeju .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#rjmncmzeju .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#rjmncmzeju .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#rjmncmzeju .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#rjmncmzeju .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#rjmncmzeju .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#rjmncmzeju .gt_two_val_uncert {\r\n  display: inline-block;\r\n  line-height: 1em;\r\n  text-align: right;\r\n  font-size: 60%;\r\n  vertical-align: -0.25em;\r\n  margin-left: 0.1em;\r\n}\r\n\r\n#rjmncmzeju .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 75%;\r\n  vertical-align: 0.4em;\r\n}\r\n\r\n#rjmncmzeju .gt_asterisk {\r\n  font-size: 100%;\r\n  vertical-align: 0;\r\n}\r\n\r\n#rjmncmzeju .gt_slash_mark {\r\n  font-size: 0.7em;\r\n  line-height: 0.7em;\r\n  vertical-align: 0.15em;\r\n}\r\n\r\n#rjmncmzeju .gt_fraction_numerator {\r\n  font-size: 0.6em;\r\n  line-height: 0.6em;\r\n  vertical-align: 0.45em;\r\n}\r\n\r\n#rjmncmzeju .gt_fraction_denominator {\r\n  font-size: 0.6em;\r\n  line-height: 0.6em;\r\n  vertical-align: -0.05em;\r\n}\r\nterm\r\n      estimate\r\n      std.error\r\n      statistic\r\n      p.value\r\n    (Intercept)\r\n16.392765\r\n0.47342061\r\n34.62622\r\n2.380425e-30Unemployment\r\n-1.106116\r\n0.05576808\r\n-19.83421\r\n1.206197e-21\r\n\r\n# But here we'll utilize the pipe to specifically style the table\r\ngt_table <- \r\n  gt_table %>% \r\n  tab_options(\r\n    table.font.size = 14\r\n  ) %>% \r\n  tab_style(\r\n    style = cell_text(weight = \"bold\"),\r\n    locations = cells_body()\r\n  ) %>% \r\n  tab_header(\r\n    title = \"Inflation Rate (CPIAUCSL) regressed against Unemployment Rate (UNRATE)\",\r\n    subtitle = md(\"1980 to 2020 Monthly but conditioned on high inflation regimes\")\r\n  ) %>% \r\n  tab_source_note(\r\n    source_note = md(\"Source: FRED at https://fred.stlouisfed.org/\")\r\n  ) %>% cols_label(\r\n    term = \"Coefficient\",\r\n    estimate = \"Estimate\",\r\n    std.error = \"Std Error\",\r\n    statistic = \"t-stat\",\r\n    p.value = \"p value\"\r\n  ) %>% fmt_number(\r\n    columns = vars(estimate, std.error, statistic),\r\n    decimals = 3\r\n  ) %>% fmt_scientific(\r\n    columns = vars(p.value),\r\n  ) %>% \r\n  tab_options(\r\n    heading.title.font.size = 14,\r\n    heading.subtitle.font.size = 12\r\n  ) %>% \r\n  tab_footnote(\r\n    footnote = \"Filtered on months with inflation >4.3% deliberately to generate regression results\",\r\n    locations = cells_title(\"subtitle\")\r\n  )\r\n\r\ngt_table\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#gcfwsqcvca .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#gcfwsqcvca .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#gcfwsqcvca .gt_title {\r\n  color: #333333;\r\n  font-size: 14px;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#gcfwsqcvca .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 12px;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#gcfwsqcvca .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#gcfwsqcvca .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#gcfwsqcvca .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#gcfwsqcvca .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#gcfwsqcvca .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#gcfwsqcvca .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#gcfwsqcvca .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 5px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#gcfwsqcvca .gt_group_heading {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#gcfwsqcvca .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#gcfwsqcvca .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#gcfwsqcvca .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#gcfwsqcvca .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#gcfwsqcvca .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#gcfwsqcvca .gt_stub_row_group {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  vertical-align: top;\r\n}\r\n\r\n#gcfwsqcvca .gt_row_group_first td {\r\n  border-top-width: 2px;\r\n}\r\n\r\n#gcfwsqcvca .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#gcfwsqcvca .gt_first_summary_row {\r\n  border-top-style: solid;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#gcfwsqcvca .gt_first_summary_row.thick {\r\n  border-top-width: 2px;\r\n}\r\n\r\n#gcfwsqcvca .gt_last_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#gcfwsqcvca .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#gcfwsqcvca .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#gcfwsqcvca .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#gcfwsqcvca .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#gcfwsqcvca .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#gcfwsqcvca .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#gcfwsqcvca .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#gcfwsqcvca .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#gcfwsqcvca .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#gcfwsqcvca .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#gcfwsqcvca .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#gcfwsqcvca .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#gcfwsqcvca .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#gcfwsqcvca .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#gcfwsqcvca .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#gcfwsqcvca .gt_two_val_uncert {\r\n  display: inline-block;\r\n  line-height: 1em;\r\n  text-align: right;\r\n  font-size: 60%;\r\n  vertical-align: -0.25em;\r\n  margin-left: 0.1em;\r\n}\r\n\r\n#gcfwsqcvca .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 75%;\r\n  vertical-align: 0.4em;\r\n}\r\n\r\n#gcfwsqcvca .gt_asterisk {\r\n  font-size: 100%;\r\n  vertical-align: 0;\r\n}\r\n\r\n#gcfwsqcvca .gt_slash_mark {\r\n  font-size: 0.7em;\r\n  line-height: 0.7em;\r\n  vertical-align: 0.15em;\r\n}\r\n\r\n#gcfwsqcvca .gt_fraction_numerator {\r\n  font-size: 0.6em;\r\n  line-height: 0.6em;\r\n  vertical-align: 0.45em;\r\n}\r\n\r\n#gcfwsqcvca .gt_fraction_denominator {\r\n  font-size: 0.6em;\r\n  line-height: 0.6em;\r\n  vertical-align: -0.05em;\r\n}\r\nInflation Rate (CPIAUCSL) regressed against Unemployment Rate (UNRATE)\r\n    1980 to 2020 Monthly but conditioned on high inflation regimes1\r\n    Coefficient\r\n      Estimate\r\n      Std Error\r\n      t-stat\r\n      p value\r\n    (Intercept)\r\n16.393\r\n0.473\r\n34.626\r\n2.38 × 10−30Unemployment\r\n−1.106\r\n0.056\r\n−19.834\r\n1.21 × 10−21Source: FRED at https://fred.stlouisfed.org/\r\n    1 Filtered on months with inflation >4.3% deliberately to generate regression results\r\n    \r\n\r\nThe question does not utilize a scatterplot but here it is anyway\r\n\r\n\r\ndf2 %>% ggplot(aes(Unemployment, Inflation_Rate)) + \r\n  geom_point() +\r\n  geom_smooth(method = \"lm\")\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-16-bt-pq-p1-t2-20-16-1-univariate-regression-inflation-versus-unemployment/bt-pq-p1-t2-20-16-1-univariate-regression-inflation-versus-unemployment_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-05-02T17:58:28-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-30-velocity-of-money/",
    "title": "velocity of money",
    "description": "MV = PY illustrates the problem but is tautological",
    "author": [
      {
        "name": "David Harper",
        "url": "https://www.bionicturtle.com/"
      }
    ],
    "date": "2022-01-03",
    "categories": [],
    "contents": "\r\nThe quantity equation is given by M * V = P * Y. My motivation here is: although recent CPI (inflation) numbers are higher (> 5.0%), they aren’t nearly as high as you might expect given the dramatic jump in the quantity of money (I’m just looking at M1 here). A common explanation I’ve read is the same that Cathie Wood recently gave (in tweet reply to Jack Dorsey now-infamous hyperinflation claim) here at her twitter account. She said “velocity is still falling.”\r\nFRED key (private), echo=FALSE\r\n\r\n\r\n\r\n\r\n\r\nlibrary(fredr)\r\nlibrary(tidyverse)\r\nlibrary(patchwork)\r\nlibrary(ggthemes)\r\n\r\nobs_start = as.Date(\"2016-07-01\")\r\nobs_end = as.Date(\"2021-04-01\") # not used\r\n\r\nY_realGDP = \"GDPC1\"; P_deflator = \"GDPDEF\"\r\nM_quantity = \"M1NS\"; V_velocity = \"M1V\"\r\n\r\nfredr_set_key(davidh_key)\r\n\r\nparams <- list(\r\n  series_id = c(Y_realGDP, P_deflator, M_quantity, V_velocity),\r\n  frequency = \"q\"\r\n)\r\n\r\nt1 <- pmap_dfr(\r\n  .l = params,\r\n  .f = ~ fredr(series_id = .x, frequency = .y)\r\n)\r\n\r\nt2 <- t1 %>% pivot_wider(names_from = series_id) %>% select(!starts_with(\"realtime\"))\r\nt3 <- t2 %>% filter(date >= obs_start)\r\n\r\na1 = 8000; b1 = 100\r\nsz_line = 1.5\r\nclr_Y = \"darkorange2\"\r\nclr_P = \"firebrick1\"\r\nclr_M = \"darkgreen\"\r\nclr_V = \"darkorchid3\"\r\n\r\n\r\np1 <- ggplot(t3, aes(x = date)) + \r\n  geom_line(aes(y = GDPC1), size = sz_line, color = clr_Y) +\r\n  geom_line(aes(y = GDPDEF * b1 + a1), size = sz_line, color = clr_P) +\r\n  scale_y_continuous(\r\n    name = \"Real GDP (Y)\", \r\n    sec.axis = sec_axis(~ (. - a1)/b1, name = \"Price Level (P)\")\r\n  ) + \r\n  theme_few() +\r\n  theme(\r\n    axis.title.x = element_blank(),\r\n    axis.title.y.left = element_text(color = clr_Y),\r\n    axis.text.y.left = element_text(color = clr_Y),\r\n    axis.title.y.right = element_text(color = clr_P),\r\n    axis.text.y.right = element_text(color = clr_P)\r\n  )\r\n  \r\na2 = 0; b2 = 1/1000\r\n\r\np2 <- ggplot(t3, aes(x = date)) + \r\n  geom_line(aes(y = M1V), size = sz_line, color = clr_V) +\r\n  geom_line(aes(y = a2 + M1NS * b2), size = sz_line, color = clr_M) + \r\n  scale_y_continuous(\r\n    name = \"Velocity (V)\", \r\n    sec.axis = sec_axis(~ (. - a2)/b2, name = \"Quantity of Money (M)\")\r\n  ) + \r\n  theme_few() +\r\n  theme(\r\n    axis.title.x = element_blank(),\r\n    axis.title.y.left = element_text(color = clr_V),\r\n    axis.text.y.left = element_text(color = clr_V),\r\n    axis.title.y.right = element_text(color = clr_M),\r\n    axis.text.y.right = element_text(color = clr_M)\r\n  )\r\n\r\np1 + p2\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-30-velocity-of-money/velocity-of-money_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-01-30T17:59:02-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-11-new-distill-site-in-15-minutes/",
    "title": "New distill site in 15 minutes",
    "description": "Distill is so much easier than blogdown",
    "author": [
      {
        "name": "David Harper",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2022-01-02",
    "categories": [],
    "contents": "\r\nGoodbye Blogdown (+hugo), hello Distill\r\nMy current (soon to be previous) data blog is a blogdown site. The setup/installation of blogdown was not difficult, but it is a PITA to maintain; e.g., new ggplot images aren’t rendering on the last package update. On Sunday after hours trying to fix the blogdown configuration, I even resorted to hiring quick help at codementor.com for the first time in my life, but even their expert could not fix the problem. The first time it was pretty straightforward, and it should still be, but after searching to debug my problem, I observed that I was not alone in my frustration with blogdown. I figured, there MUST be a better way to simply share data analyses (without going to Rpubs, I mean)?\r\nThen I stumbled onto Lisa Lendway’s post. She also had a “blogdown fail!” and she explains why she switched to the distill package. How did I miss this revelation?! Boom. This setup here took me a grand total of 15 minutes to install. No glitches! Distill is light-weight and somewhat customizable; e.g., I borrowed the tidymodels.css stylesheet and changed my titles to CeriFi’s color (#193053) because, you know, color makes me happy. No mess. No fuss. Here are the basic steps:\r\nInstall distill package and build site with create_website (ype, one line of code!)\r\nCreate a local git repo (at the distill directory just created) and connect that to a remote GitHub repo; mine is here. So this github repo is remote a copy of the webite\r\nUse the netlify to publish from the _site sub-directory. Netflify is amazing.\r\nAdding a blog entry is easy:\r\ncreate_post(title = “I love distill because it’s easy and it works!”) which is an RMarkdown file\r\nKnit the post (to view locally); article must be knitted individually\r\nWhen ready, “Build Website” in RStuio’s Build pane; i.e., executes rmarkdown::render_site()\r\nCommit and push to github. Netlify allows for continous deployment if you build from the github repo and specify _site as the Publish directory\r\nDistill’s lightweight file structure\r\nWith the command create_website(), a simple file structure is created:\r\ncreate_website() installs these filesThe _site.yml contains the reference to the theme.css. I borrowed the tidymodels.css theme with only a color change.\r\n_site.yml controls detailsMy About page is courtesy of Alison Hill’s tutorial; in <3 minutes, I installed the postcard package and switched the page’s style to trestles with a quick edit to the YAML\r\narticle’s YAML front-matter with built-in trestles theme\r\n\r\n\r\n",
    "preview": "posts/2022-01-11-new-distill-site-in-15-minutes/distill_hex_symbol_5percent.png",
    "last_modified": "2022-01-30T17:49:11-08:00",
    "input_file": {}
  }
]
